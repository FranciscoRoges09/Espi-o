(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[920],{82380:function(e,t,n){"use strict";n.d(t,{m:function(){return r}});var o=n(52322),a=n(14741);n(2784);let r=e=>{let{error:t}=e;return(0,o.jsx)("div",{style:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",padding:"0 1rem"},children:a.O.NEXT_PUBLIC_VIEWER_URL[0]?(0,o.jsx)("p",{style:{fontSize:"24px",textAlign:"center"},children:t.message}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h1",{style:{fontWeight:"bold",fontSize:"30px"},children:"NEXT_PUBLIC_VIEWER_URL is missing"}),(0,o.jsxs)("h2",{children:["Make sure to configure the app properly (",(0,o.jsx)("a",{href:"https://docs.typebot.io/self-hosting/configuration",children:"https://docs.typebot.io/self-hosting/configuration"}),")"]})]})})}},56749:function(e,t,n){"use strict";n.d(t,{A:function(){return r}});var o=n(52322),a=n(14741);let r=()=>(0,o.jsxs)("div",{style:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[(0,o.jsx)("h1",{style:{fontWeight:"bold",fontSize:"30px"},children:a.O.NEXT_PUBLIC_VIEWER_404_TITLE}),(0,o.jsx)("h2",{children:a.O.NEXT_PUBLIC_VIEWER_404_SUBTITLE})]})},61998:function(e,t,n){"use strict";n.d(t,{H:function(){return p}});var o=n(52322),a=n(54260),r=n(14741),i=n(32548),l=n(78326),s=n(97729),d=n.n(s),u=n(45847),c=n.n(u);n(2784);let p=e=>{let{url:t,typebotName:n,isMatchingViewerUrl:s,metadata:{title:u,description:p,favIconUrl:m,imageUrl:b,googleTagManagerId:g}={}}=e;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(d(),{children:[(0,o.jsx)("title",{children:null!=u?u:n}),s?(0,o.jsx)("meta",{name:"robots",content:"noindex"}):null,(0,o.jsx)("link",{rel:"icon",type:"image/png",href:null!=m?m:l.he.metadata.favIconUrl(r.O.NEXT_PUBLIC_VIEWER_URL[0])}),(0,o.jsx)("meta",{name:"title",content:null!=u?u:n}),(0,o.jsx)("meta",{name:"description",content:null!=p?p:"Build beautiful conversational forms and embed them directly in your applications without a line of code. Triple your response rate and collect answers that has more value compared to a traditional form."}),(0,o.jsx)("meta",{property:"og:type",content:"website"}),(0,o.jsx)("meta",{property:"og:url",content:null!=t?t:"https://bot.typebot.io"}),(0,o.jsx)("meta",{property:"og:title",content:null!=u?u:n}),(0,o.jsx)("meta",{property:"og:site_name",content:null!=u?u:n}),(0,o.jsx)("meta",{property:"og:description",content:null!=p?p:"Build beautiful conversational forms and embed them directly in your applications without a line of code. Triple your response rate and collect answers that has more value compared to a traditional form."}),(0,o.jsx)("meta",{property:"og:image",itemProp:"image",content:null!=b?b:l.he.metadata.imageUrl(r.O.NEXT_PUBLIC_VIEWER_URL[0])}),(0,o.jsx)("meta",{property:"twitter:card",content:"summary_large_image"}),(0,o.jsx)("meta",{property:"twitter:url",content:null!=t?t:"https://bot.typebot.io"}),(0,o.jsx)("meta",{property:"twitter:title",content:null!=u?u:n}),(0,o.jsx)("meta",{property:"twitter:description",content:null!=p?p:"Build beautiful conversational forms and embed them directly in your applications without a line of code. Triple your response rate and collect answers that has more value compared to a traditional form."}),(0,o.jsx)("meta",{property:"twitter:image",content:null!=b?b:l.he.metadata.imageUrl(r.O.NEXT_PUBLIC_VIEWER_URL[0])})]},"seo"),(0,i.UE)(g)&&(0,o.jsx)(c(),{id:"google-tag-manager",children:(0,a.J)(g)})]})}},89383:function(e,t,n){"use strict";n.d(t,{i:function(){return o$}});var o,a,r,i,l,s,d,u,c,p,m,b,g,h,v,f,y,w,E,I=n(52322),x=n(32548);let T=async e=>(0,x.wG)({url:"/api/typebots/t/results/r/answers",method:"PUT",body:e}),_=async e=>(0,x.wG)({url:"/api/typebots/".concat(e,"/results"),method:"POST"}),C=async(e,t)=>(0,x.wG)({url:"/api/typebots/t/results/".concat(e),method:"PATCH",body:t}),S="resultId",P=()=>{try{return sessionStorage.getItem(S)}catch(e){}},N=e=>{try{return sessionStorage.setItem(S,e)}catch(e){}};var k=n(54260),A=n(78326),L=n(31587),R=n(14741),j=n(24945),U=n(2784);(a=p||(p={})).TEXT="text",a.IMAGE="image",a.VIDEO="video",a.EMBED="embed",a.AUDIO="audio",(r=m||(m={})).TEXT="text input",r.NUMBER="number input",r.EMAIL="email input",r.URL="url input",r.DATE="date input",r.PHONE="phone number input",r.CHOICE="choice input",r.PICTURE_CHOICE="picture choice input",r.PAYMENT="payment input",r.RATING="rating input",r.FILE="file input",(i=b||(b={})).GOOGLE_SHEETS="Google Sheets",i.OPEN_AI="OpenAI",i.GOOGLE_ANALYTICS="Google Analytics",i.HTTP_REQUEST="Webhook",i.EMAIL="Email",i.ZAPIER="Zapier",i.MAKE_COM="Make.com",i.PABBLY_CONNECT="Pabbly",i.CHATWOOT="Chatwoot",i.PIXEL="Pixel",(l=g||(g={})).SET_VARIABLE="Set variable",l.CONDITION="Condition",l.REDIRECT="Redirect",l.SCRIPT="Code",l.TYPEBOT_LINK="Typebot link",l.WAIT="Wait",l.JUMP="Jump",l.AB_TEST="AB test",l.WEBHOOK="webhook";let O=["openai","cal-com","chat-node","qr-code","dify-ai","mistral","elevenlabs","anthropic","together-ai","open-router","nocodb","segment","groq","zendesk"];var z=n(30195),B=n(98786);void 0===(o=z.z).ZodType.prototype.layout&&(o.ZodType.prototype.layout=function(e){return new this.constructor({...this._def,layout:e})}),(0,B.T)(z.z);let V=z.z.array(z.z.string().nullable()),M=z.z.object({id:z.z.string(),name:z.z.string(),isSessionVariable:z.z.boolean().optional()});M.extend({value:z.z.string().or(V).nullish()}),M.extend({value:z.z.string().or(V)}),M.extend({value:z.z.unknown()});let D=z.z.custom(e=>/^{{.+}}$/g.test(e));z.z.object({resultId:z.z.string(),index:z.z.number(),blockId:z.z.string(),variableId:z.z.string(),value:z.z.string().or(V).nullable()});let K={object:e=>z.z.object(e),literal:e=>z.z.literal(e),string:z.z.string().optional(),boolean:z.z.boolean().optional(),enum:e=>z.z.enum(e).optional(),number:z.z.number().or(D).optional(),array:e=>z.z.array(e).optional(),discriminatedUnion:(e,t)=>z.z.discriminatedUnion(e,[z.z.object({[e]:z.z.undefined()}),...t]),saveResponseArray:(e,t)=>{var n,o;return z.z.array(z.z.object({item:z.z.enum(e).optional().layout({...null!==(n=null==t?void 0:t.item)&&void 0!==n?n:{},placeholder:"Select a response",defaultValue:e[0]}),variableId:z.z.string().optional().layout({...null!==(o=null==t?void 0:t.variableId)&&void 0!==o?o:{},inputType:"variableDropdown"})})).optional()},filter:e=>{let{operators:t=H,isJoinerHidden:n}=e;return z.z.object({comparisons:z.z.array(z.z.object({input:z.z.string().optional().layout({label:"Enter a field "}),operator:z.z.enum(t).optional().layout({defaultValue:"Equal to"}),value:z.z.string().optional().layout({placeholder:"Enter a value"})})),joiner:z.z.enum(["AND","OR"]).optional().layout({placeholder:"Select joiner",isHidden:n})}).optional()}},H=["Equal to","Not equal","Contains","Does not contain","Greater than","Less than","Is set","Is empty","Starts with","Ends with","Matches regex","Does not match regex"];var G=n(5644),F=n(94207),W=n(23301);let X=async e=>{let{input:t,shouldDownloadImages:n}=e,o=t.split("\n\n"),a=[];for(let e of o){var r,i;if(e.startsWith("http")||e.startsWith('["http'))for(let t of e.startsWith("[")?JSON.parse(e):[e]){let e=t.trim();try{let o=await F.ZP.get(e);o.ok&&(null===(r=o.headers.get("content-type"))||void 0===r?void 0:r.startsWith("image/"))?a.push({type:"image",image:n?await o.arrayBuffer():t.trim()}):a.push({type:"text",text:e})}catch(e){e instanceof W.B?console.log(e.response.status,await e.response.text()):console.error(e)}}else if((null===(i=a.at(-1))||void 0===i?void 0:i.type)==="text"){let t=a.at(-1);(a=a.slice(0,-1)).push({type:"text",text:t.text+"\n\n"+e})}else a.push({type:"text",text:e})}return a},q=async e=>{let{messages:t,isVisionEnabled:n,shouldDownloadImages:o,variables:a}=e;return t?(await Promise.all(t.map(async e=>{if(e.role)return"Dialogue"===e.role?Y({message:e,variables:a,isVisionEnabled:n,shouldDownloadImages:o}):Z({message:e,variables:a,isVisionEnabled:n,shouldDownloadImages:o})}))).flat().filter(x.$K):[]},Y=async e=>{var t;let{message:n,variables:o,isVisionEnabled:a,shouldDownloadImages:r}=e;if(!n.dialogueVariableId)return;let i=null!==(t=o.get(n.dialogueVariableId))&&void 0!==t?t:[];return Promise.all((Array.isArray(i)?i:[i]).map(async(e,t)=>{if(e)return 0===t&&"assistant"===n.startsBy?{role:"assistant",content:e}:t%("assistant"===n.startsBy?1:2)==0?{role:"user",content:a?await X({input:null!=e?e:"",shouldDownloadImages:r}):e}:{role:"assistant",content:e}}))},Z=async e=>{let{message:t,variables:n,isVisionEnabled:o,shouldDownloadImages:a}=e;if(!t.content)return;let r=n.parse(t.content);if(!(0,x.xb)(r))return"user"===t.role?{role:"user",content:o?await X({input:r,shouldDownloadImages:a}):r}:{role:t.role,content:r}},J=e=>{if((0,x.z4)(e))return null;if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return console.warn("Failed to safely stringify variable value",e),null}},$=e=>"string"==typeof e?e:e instanceof Error?e.name+": "+e.message:JSON.stringify(e);var Q=n(91331),ee=n.n(Q);let et={isolate:void 0},en=()=>(et.isolate||(et.isolate=new Q.Isolate),et.isolate),eo=e=>{if(null===e)return null;if(void 0===e)return;if("string"!=typeof e)return e;let t=e.startsWith("0")&&!e.startsWith("0.")&&e.length>1;if("string"==typeof e&&t)return e;let n=e.startsWith("+");return"string"==typeof e&&n||"number"==typeof e?e:"true"===e||"false"!==e&&("null"===e?null:"undefined"!==e?isNaN(e)?e:Number(e):void 0)},ea=e=>{let{variables:t}=e,n=en().createContextSync(),o=n.global;return o.setSync("global",o.derefInto()),t.forEach(e=>{o.setSync(e.id,er(eo(e.value)))}),e=>n.evalClosureSync("return (function() {\n    return new Function($0)();\n  }())",[e],{result:{copy:!0},timeout:1e4})},er=e=>"object"==typeof e?new(ee()).ExternalCopy(e).copyInto():e,ei=e=>t=>[...t.matchAll(/\{\{(.*?)\}\}/g)].reduce((t,n)=>{let o=n[1],a=e.find(e=>e.name===o);return!a||t.find(e=>e.id===a.id)?t:[...t,a]},[]),el={fieldToParse:"value",isInsideJson:!1,takeLatestIfList:!1,isInsideHtml:!1},es=/\{\{=(.+?)=\}\}/g,ed=/\{\{([^{}]+)\}\}|(\$)\{\{([^{}]+)\}\}/g,eu=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:el;return n=>n&&""!==n?n.replace(es,(t,n)=>{var o;let a=ec(n,{variables:e});return null!==(o=J(a))&&void 0!==o?o:a}).replace(ed,(n,o,a,r)=>{let i=null!=a?a:"",l=null!=o?o:r,s=e.find(e=>l===e.name&&("id"===t.fieldToParse||(0,x.$K)(e.value)));if(!s)return i+"";if("id"===t.fieldToParse)return i+s.id;let{value:d}=s;if(t.isInsideJson)return i+ep(d);let u=i+J(t.takeLatestIfList&&Array.isArray(d)?d[d.length-1]:d);return u?t.isInsideHtml?em(u):u:i+""}):""},ec=(e,t)=>{let{variables:n}=t;try{let t=eu(n,{fieldToParse:"id"})(e);return ea({variables:n})(t.includes("return ")?t:"return ".concat(t))}catch(t){return eu(n)(e)}},ep=e=>{let t=JSON.stringify(e);return"string"==typeof e?t.slice(1,-1):t},em=e=>"string"==typeof e?e.replace(/</g,"&lt;").replace(/>/g,"&gt;"):JSON.stringify(e).replace(/</g,"&lt;").replace(/>/g,"&gt;"),eb=async e=>{let{variables:t,body:n,args:o}=e,a=eu(t,{fieldToParse:"id"})(n),r=ei(t)(n).map(e=>({id:e.id,value:eo(e.value)})).concat(o?Object.entries(o).map(e=>{let[t,n]=e;return{id:t,value:n}}):[]),i=new Map,l=en().createContextSync(),s=l.global;s.setSync("global",s.derefInto()),l.evalClosure("globalThis.setVariable = (...args) => $0.apply(undefined, args, { arguments: { copy: true }, promise: true, result: { copy: true, promise: true } })",[new Q.Reference((e,t)=>{i.set(e,t)})]),l.evalClosure("globalThis.fetch = (...args) => $0.apply(undefined, args, { arguments: { copy: true }, promise: true, result: { copy: true, promise: true } })",[new Q.Reference(async function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(await fetch(...t)).text()})]),r.forEach(e=>{let{id:t,value:n}=e;s.setSync(t,er(n))});try{return{output:await l.evalClosure("return (async function() {\n		const AsyncFunction = async function () {}.constructor;\n		return new AsyncFunction($0)();\n	}())",[a],{result:{copy:!0,promise:!0},timeout:1e4}),newVariables:Array.from(i.entries()).map(e=>{let[n,o]=e,a=t.find(e=>e.name===n);if(a)return{id:a.id,name:a.name,value:o}}).filter(x.$K)}}catch(t){console.log("Error while executing script"),console.error(t);let e=$(t);return{error:e,output:e}}},eg=e=>{let{tools:t,variables:n}=e;return(null==t?void 0:t.length)?t.reduce((e,t)=>(t.code&&t.name&&(e[t.name]={description:t.description,parameters:eh(t.parameters),execute:async e=>{var o;let{output:a,newVariables:r}=await eb({variables:n.list(),args:e,body:t.code});return r&&r.length>0&&n.set(r),null!==(o=J(a))&&void 0!==o?o:""}}),e),{}):{}},eh=e=>{if(!e||(null==e?void 0:e.length)===0)return;let t={};return e.forEach(e=>{if(e.name){switch(e.type){case"string":t[e.name]=z.z.string();break;case"number":t[e.name]=z.z.number();break;case"boolean":t[e.name]=z.z.boolean();break;case"enum":if(!e.values||0===e.values.length)return;t[e.name]=z.z.enum(e.values)}(0,x.UE)(e.description)&&(t[e.name]=t[e.name].describe(e.description)),!1===e.required&&(t[e.name]=t[e.name].optional())}}),z.z.object(t)},ev={name:K.string.layout({label:"Name",placeholder:"myVariable",withVariableButton:!1}),description:K.string.layout({label:"Description",withVariableButton:!1}),required:K.boolean.layout({label:"Is required?"})},ef=K.array(K.discriminatedUnion("type",[K.object({type:K.literal("string")}).extend(ev),K.object({type:K.literal("number")}).extend(ev),K.object({type:K.literal("boolean")}).extend(ev),K.object({type:K.literal("enum"),values:K.array(K.string).layout({itemLabel:"possible value"})}).extend(ev)])).layout({accordion:"Parameters",itemLabel:"parameter"}),ey=K.object({type:K.literal("function"),name:K.string.layout({label:"Name",placeholder:"myFunctionName",withVariableButton:!1}),description:K.string.layout({label:"Description",placeholder:"A brief description of what this function does.",withVariableButton:!1}),parameters:ef,code:K.string.layout({inputType:"code",label:"Code",lang:"javascript",moreInfoTooltip:"A javascript code snippet that can use the defined parameters. It should return a value.",withVariableButton:!1})}),ew=K.array(K.discriminatedUnion("type",[ey])).layout({accordion:"Tools",itemLabel:"tool"});var eE=n(88731);let eI={type:"encryptedCredentials",name:"Anthropic account",schema:K.object({apiKey:K.string.layout({label:"API key",isRequired:!0,inputType:"password",helperText:"You can generate an API key [here](https://console.anthropic.com/settings/keys).",placeholder:"sk-...",withVariableButton:!1,isDebounceDisabled:!0})})},ex=["claude-3-5-haiku-latest","claude-3-5-sonnet-latest","claude-3-5-sonnet-20240620","claude-3-opus-20240229","claude-3-sonnet-20240229","claude-3-haiku-20240307","claude-2.1","claude-2.0","claude-instant-1.2"],eT={"claude-3-5-haiku-latest":"Claude 3.5 Haiku","claude-3-5-sonnet-latest":"Claude 3.5 Sonnet","claude-3-5-sonnet-20240620":"Claude 3.5 Sonnet","claude-3-opus-20240229":"Claude 3.0 Opus","claude-3-sonnet-20240229":"Claude 3.0 Sonnet","claude-3-haiku-20240307":"Claude 3.0 Haiku","claude-2.1":"Claude 2.1","claude-2.0":"Claude 2.0","claude-instant-1.2":"Claude Instant 1.2"},e_={model:"claude-3-opus-20240229",temperature:1,maxTokens:1024},eC=["claude-3*"];function eS(e){return"-"===e||"^"===e||"$"===e||"+"===e||"."===e||"("===e||")"===e||"|"===e||"["===e||"]"===e||"{"===e||"}"===e||"*"===e||"?"===e||"\\"===e?"\\".concat(e):e}function eP(e,t){if("string"!=typeof t)throw TypeError("Sample must be a string, but ".concat(typeof t," given"));return e.test(t)}let eN=(e,t)=>{if("string"!=typeof e&&!Array.isArray(e))throw TypeError("The first argument must be a single pattern string or an array of patterns, but ".concat(typeof e," given"));if(("string"==typeof t||"boolean"==typeof t)&&(t={separator:t}),"\\"===(t=t||{}).separator)throw Error("\\ is not a valid separator because it is used for escaping. Try setting the separator to `true` instead");let n=function e(t){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(Array.isArray(t)){let o=t.map(t=>"^".concat(e(t,n),"$"));return"(?:".concat(o.join("|"),")")}let o="",a="",r=".";!0===n?(o="/",a="[/\\\\]",r="[^/\\\\]"):n&&((a=function(e){let t="";for(let n=0;n<e.length;n++)t+=eS(e[n]);return t}(o=n)).length>1?(a="(?:".concat(a,")"),r="((?!".concat(a,").)")):r="[^".concat(a,"]"));let i=n?"".concat(a,"+?"):"",l=n?"".concat(a,"*?"):"",s=n?t.split(o):[t],d="";for(let e=0;e<s.length;e++){let t=s[e],o=s[e+1],a="";if(t||!(e>0)){if(n&&(a=e===s.length-1?l:"**"!==o?i:""),n&&"**"===t){a&&(d+=(0===e?"":a)+"(?:".concat(r,"*?").concat(a,")*?"));continue}if(t){for(let e=0;e<t.length;e++){let n=t[e];"\\"===n?e<t.length-1&&(d+=eS(t[e+1]),e++):"?"===n?d+=r:"*"===n?d+="".concat(r,"*?"):d+=eS(n)}d+=a}}}return d}(e,t.separator),o=new RegExp("^".concat(n,"$"),t.flags),a=eP.bind(null,o);return a.options=t,a.pattern=e,a.regexp=o,a},ek=e=>!!e&&eN(eC)(e),eA=e=>{let{messages:t,toolCalls:n,toolResults:o}=e;return n.length>0&&t.push({role:"assistant",content:n}),o.length>0&&t.push({role:"tool",content:o}),t},eL=async(e,t)=>{let{done:n,value:o}=await t.read();if(!n)return e.enqueue(o),eL(e,t)};var eR=n(96540);let ej={content:K.string.layout({inputType:"textarea",placeholder:"Content"})},eU=K.object({role:K.literal("user")}).extend(ej),eO=K.object({role:K.literal("assistant")}).extend(ej),ez=K.object({role:K.literal("Dialogue"),dialogueVariableId:K.string.layout({inputType:"variableDropdown",placeholder:"Dialogue variable"}),startsBy:K.enum(["user","assistant"]).layout({label:"starts by",direction:"row",defaultValue:"user"})}),eB=(K.object({model:K.enum(ex).layout({toLabels:e=>e?eT[e]:void 0,hiddenItems:["claude-3-5-sonnet-20240620","claude-2.1","claude-2.0","claude-instant-1.2"],placeholder:"Select a model"}),messages:K.array(K.discriminatedUnion("role",[eU,eO,ez])).layout({accordion:"Messages",itemLabel:"message",isOrdered:!0}),tools:ew,systemMessage:K.string.layout({accordion:"Advanced Settings",label:"System prompt",direction:"row",inputType:"textarea"}),temperature:K.number.layout({accordion:"Advanced Settings",label:"Temperature",direction:"row",defaultValue:e_.temperature}),maxTokens:K.number.layout({accordion:"Advanced Settings",label:"Max Tokens",direction:"row",defaultValue:e_.maxTokens}),responseMapping:K.saveResponseArray(["Message Content"]).layout({accordion:"Save Response"})}),{variableId:K.string.layout({inputType:"variableDropdown"}),description:K.string.layout({label:"Description",accordion:"Advanced"}),isRequired:K.boolean.layout({label:"Is required",moreInfoTooltip:"If set to false, there is a chance the variable will be empty",accordion:"Advanced",defaultValue:!0})}),eV=K.array(K.discriminatedUnion("type",[K.object({type:K.literal("string")}).extend(eB),K.object({type:K.literal("number")}).extend(eB),K.object({type:K.literal("boolean")}).extend(eB),K.object({type:K.literal("enum"),values:K.array(K.string).layout({itemLabel:"possible value",mergeWithLastField:!0})}).extend(eB)])).layout({itemLabel:"variable mapping",accordion:"Schema"}),eM=e=>{let{defaultModel:t,modelFetch:n,modelHelperText:o}=e;return K.object({model:"string"==typeof n?K.string.layout({placeholder:"Select a model",label:"Model",fetcher:n,helperText:o}):K.enum(n).layout({placeholder:"Select a model",label:"Model",helperText:o}),prompt:K.string.layout({label:"Prompt",placeholder:"Type your text here",inputType:"textarea",isRequired:!0,moreInfoTooltip:'Meant to guide the model on what to generate. i.e. "Generate a role-playing game character", "Extract the company name from this text", etc.'}),variablesToExtract:eV})},eD=async e=>{let{variablesToExtract:t,model:n,prompt:o,variables:a,logs:r}=e;if(!o)return r.add("No prompt provided");let i=a.list(),l=eK({variablesToExtract:t,variables:i});if(!l){r.add("Could not parse variables to extract");return}let s=null==t?void 0:t.some(e=>!1===e.isRequired),{object:d}=await (0,eE.jA)({model:n,schema:l,prompt:"".concat(o,"\n\nYou should generate a JSON object")+(s?" and provide empty values if the information is not there or if you are unsure.":".")});Object.entries(d).forEach(e=>{let[t,n]=e;if(null===n)return;let o=i.find(e=>e.name===t);o&&a.set([{id:o.id,value:n}])})},eK=e=>{let{variablesToExtract:t,variables:n}=e;if(!t||(null==t?void 0:t.length)===0)return;let o={};return t.forEach(e=>{if(!e)return;let t=n.find(t=>t.id===e.variableId);if(t){switch(e.type){case"string":o[t.name]=z.z.string();break;case"number":o[t.name]=z.z.number();break;case"boolean":o[t.name]=z.z.boolean();break;case"enum":if(!e.values||0===e.values.length)return;o[t.name]=z.z.enum(e.values)}!1===e.isRequired&&(o[t.name]=o[t.name].nullish()),(0,x.UE)(e.description)&&(o[t.name]=o[t.name].describe(e.description))}}),z.z.object(o)},eH=(eM({modelFetch:ex}),"https://app.cal.com"),eG=K.object({baseUrl:K.string.layout({label:"Base origin",placeholder:"https://cal.com",defaultValue:eH,accordion:"Customize host"})}),eF=(K.object({link:K.string.layout({label:"Event link",placeholder:"https://cal.com/..."}),layout:K.enum(["Month","Weekly","Columns"]).layout({label:"Layout:",defaultValue:"Month",direction:"row"}),name:K.string.layout({accordion:"Prefill information",label:"Name",placeholder:"John Doe"}),email:K.string.layout({accordion:"Prefill information",label:"Email",placeholder:"johndoe@gmail.com"}),additionalNotes:K.string.layout({accordion:"Prefill information",label:"Additional notes"}),phone:K.string.layout({accordion:"Prefill information",label:"Phone number",placeholder:"+919999999999"}),saveBookedDateInVariableId:K.string.layout({label:"Save booked date",inputType:"variableDropdown"})}),e=>{switch(e){case"Weekly":return"week_view";case"Columns":return"column_view";default:return"month_view"}}),eW={type:"encryptedCredentials",name:"ChatNode account",schema:K.object({apiKey:K.string.layout({label:"API key",isRequired:!0,helperText:"You can generate an API key [here](https://go.chatnode.ai/typebot).",inputType:"password",withVariableButton:!1,isDebounceDisabled:!0})})};K.object({botId:K.string.layout({label:"Bot ID",placeholder:"68c052c5c3680f63",moreInfoTooltip:"The bot_id you want to ask question to. You can find it at the end of your ChatBot URl in your dashboard"}),threadId:K.string.layout({label:"Thread ID",moreInfoTooltip:"Used to remember the conversation with the user. If empty, a new thread is created."}),message:K.string.layout({label:"Message",placeholder:"Hi, what can I do with ChatNode",inputType:"textarea"}),responseMapping:K.saveResponseArray(["Message","Thread ID"]).layout({accordion:"Save response"})}),async e=>{let{credentials:{apiKey:t},options:{botId:n,message:o,responseMapping:a,threadId:r},variables:i,logs:l}=e;try{let e=await F.ZP.post("https://api.public.chatnode.ai/v1/"+n,{headers:{Authorization:"Bearer ".concat(t)},json:{message:o,chat_session_id:(0,x.xb)(r)?void 0:r},timeout:!1}).json();null==a||a.forEach(t=>{var n;if(!t.variableId)return;let o=null!==(n=t.item)&&void 0!==n?n:"Message";"Message"===o&&i.set([{id:t.variableId,value:e.message}]),"Thread ID"===o&&i.set([{id:t.variableId,value:e.chat_session_id}])})}catch(e){if(e instanceof W.B)return l.add({status:"error",description:e.message,details:await e.response.text()});console.error(e)}};var eX=n(13262),eq=n(86468);let eY=(e,t)=>(0,eq.isURL)(e,{protocols:["https","http"],require_protocol:!0,...t}),eZ="https://api.dify.ai",eJ={type:"encryptedCredentials",name:"Dify.AI assistant",schema:K.object({apiEndpoint:K.string.layout({label:"API Endpoint",isRequired:!0,helperText:"URI where the Service API is hosted.",withVariableButton:!1,defaultValue:eZ}).refine(e=>!e||eY(e)).transform(e=>e?new URL(e).origin:e),apiKey:K.string.layout({label:"App API key",isRequired:!0,helperText:"API Secret Key for your Dify App.",inputType:"password",withVariableButton:!1,isDebounceDisabled:!0})})},e$=K.object({conversation_id:K.string.layout({label:"Conversation ID",moreInfoTooltip:"Used to remember the conversation with the user. If empty, a new conversation id is created.",isHidden:!0}).describe("Deprecated, use `conversationVariableId` instead")}),eQ=(K.object({query:K.string.layout({label:"Query",placeholder:"User input/question content",inputType:"textarea",isRequired:!0}),conversationVariableId:K.string.layout({label:"Conversation ID",moreInfoTooltip:"Used to remember the conversation with the user. If empty, a new conversation ID is created.",inputType:"variableDropdown"}),user:K.string.layout({label:"User",moreInfoTooltip:"The user identifier, defined by the developer, must ensure uniqueness within the app."}),inputs:K.array(K.object({key:K.string.layout({label:"Key"}),value:K.string.layout({label:"Value"})})).layout({accordion:"Inputs"}),responseMapping:K.saveResponseArray(["Answer","Conversation ID","Total Tokens"],{item:{hiddenItems:["Conversation ID"]}}).layout({accordion:"Save response"})}).merge(e$),e=>{let t=RegExp("(?<![\\([])https?:\\/\\/\\S+","g");return e.replace(t,e=>"[".concat(e,"](").concat(e,")"))}),e0=async(e,t)=>{let n="";for(;;){let{value:r,done:i}=await e.read();if(i){t.onDone();return}for(let e of new TextDecoder().decode(r).toString().split("\n").filter(e=>e.length>0&&"\n"!==e)){if((n+=e).startsWith("event: ")){n="";continue}if(!n.startsWith("data: ")||!n.endsWith("}"))continue;let r=JSON.parse(n.slice(6));if(n="",("message"===r.event||"agent_message"===r.event)&&t.onMessage(r.answer),"message_end"===r.event){var o,a;await (null===(a=t.onMessageEnd)||void 0===a?void 0:a.call(t,{totalTokens:null===(o=r.metadata.usage)||void 0===o?void 0:o.total_tokens,conversationId:r.conversation_id}))}}}};var e1=n(4897),e2=n(70767);let e5=()=>{if(!R.O.S3_ENDPOINT||!R.O.S3_ACCESS_KEY||!R.O.S3_SECRET_KEY)throw Error("S3 not properly configured. Missing one of those variables: S3_ENDPOINT, S3_ACCESS_KEY, S3_SECRET_KEY");return new e2.Client({endPoint:R.O.S3_ENDPOINT,port:R.O.S3_PORT,useSSL:R.O.S3_SSL,accessKey:R.O.S3_ACCESS_KEY,secretKey:R.O.S3_SECRET_KEY,region:R.O.S3_REGION})},e3=async e=>{let{key:t,file:n,mimeType:o}=e,a=e5();return await a.putObject(R.O.S3_BUCKET,"public/"+t,n,{"Content-Type":o,"Cache-Control":"public, max-age=86400"}),R.O.S3_PUBLIC_CUSTOM_DOMAIN?"".concat(R.O.S3_PUBLIC_CUSTOM_DOMAIN,"/public/").concat(t):"http".concat(R.O.S3_SSL?"s":"","://").concat(R.O.S3_ENDPOINT).concat(R.O.S3_PORT?":".concat(R.O.S3_PORT):"","/").concat(R.O.S3_BUCKET,"/public/").concat(t)},e4={type:"encryptedCredentials",name:"ElevenLabs account",schema:K.object({apiKey:K.string.layout({label:"API key",isRequired:!0,inputType:"password",helperText:"You can generate an API key in your ElevenLabs dashboard in the Profile menu.",isDebounceDisabled:!0,withVariableButton:!1})})},e6="https://api.elevenlabs.io";var e7=n(48834).Buffer;K.object({text:K.string.layout({label:"Text",inputType:"textarea",placeholder:"Enter the text to convert to speech"}),voiceId:K.string.layout({fetcher:"fetchVoices",label:"Voice",placeholder:"Select a voice"}),modelId:K.string.layout({fetcher:"fetchModels",label:"Model",placeholder:"Select a model"}),saveUrlInVariableId:K.string.layout({label:"Save audio URL in variable",placeholder:"Select a variable",inputType:"variableDropdown"})}),async e=>{let{credentials:t,options:n,variables:o,logs:a}=e;if(!n.voiceId)return a.add("Voice ID is missing");if(!n.text)return a.add("Text is missing");if(!n.saveUrlInVariableId)return a.add("Save variable is missing");try{let e=await F.ZP.post(e6+"/v1/text-to-speech/"+n.voiceId,{headers:{Accept:"audio/mpeg","xi-api-key":t.apiKey},json:{model_id:n.modelId,text:n.text},timeout:!1}).arrayBuffer(),a=await e3({file:e7.from(e),key:"tmp/elevenlabs/audio/".concat((0,e1.Mc)()+(0,e1.Mc)(),".mp3"),mimeType:"audio/mpeg"});o.set([{id:n.saveUrlInVariableId,value:a}])}catch(e){if(e instanceof W.B)return a.add({status:"error",description:e.message,details:await e.response.text()});a.add({status:"error",description:"An error occured while converting the text to speech",details:JSON.stringify(e,null,2)})}};let e9=e=>{var t,n;return null!==(n=null===(t=e.responseMapping)||void 0===t?void 0:t.map(e=>e.variableId).filter(x.$K))&&void 0!==n?n:[]},e8=e=>{var t,n;return null===(n=e.responseMapping)||void 0===n?void 0:null===(t=n.find(e=>"Message content"===e.item||!e.item))||void 0===t?void 0:t.variableId},te={content:K.string.layout({inputType:"textarea",placeholder:"Content"})},tt=K.object({role:K.literal("system")}).extend(te),tn=K.object({role:K.literal("user")}).extend(te),to=K.object({role:K.literal("assistant")}).extend(te),ta=K.object({role:K.literal("Dialogue"),dialogueVariableId:K.string.layout({inputType:"variableDropdown",placeholder:"Dialogue variable"}),startsBy:K.enum(["user","assistant"]).layout({label:"starts by",direction:"row",defaultValue:"user"})}),tr=e=>{let{defaultTemperature:t,modelFetchId:n,modelHelperText:o}=e;return K.object({model:K.string.layout({placeholder:n?"Select a model":void 0,label:n?void 0:"Model",fetcher:n,helperText:o}),messages:K.array(K.discriminatedUnion("role",[tt,tn,to,ta])).layout({accordion:"Messages",itemLabel:"message",isOrdered:!0}),tools:ew,temperature:K.number.layout({accordion:"Advanced settings",label:"Temperature",direction:"row",defaultValue:t}),responseMapping:K.saveResponseArray(["Message content","Total tokens"]).layout({accordion:"Save response"})})};var ti=n(44188);let tl=["gpt-4-turbo*","gpt-4o*","gpt-4*vision-preview"],ts=["gpt-4-turbo-preview"],td={model:"gpt-4o-mini",voiceModel:"tts-1",temperature:1},tu=e=>!!e&&!ts.includes(e)&&eN(tl)(e),tc=async e=>{var t,n,o,a;let{credentials:{apiKey:r},options:i,variables:l,config:s,logs:d,compatibility:u}=e;if(!r)return d.add("No API key provided");let c=null!==(n=null===(t=i.model)||void 0===t?void 0:t.trim())&&void 0!==n?n:s.defaultModel;if(!c)return d.add("No model provided");let p=(0,ti.JV)({baseURL:null!==(o=s.baseUrl)&&void 0!==o?o:i.baseUrl,apiKey:r,compatibility:u})(c);try{let{text:e,usage:t}=await (0,eE._4)({model:p,temperature:i.temperature?Number(i.temperature):void 0,messages:await q({messages:i.messages,variables:l,isVisionEnabled:tu(c),shouldDownloadImages:!1}),tools:eg({tools:i.tools,variables:l}),maxToolRoundtrips:10});null===(a=i.responseMapping)||void 0===a||a.forEach(n=>{n.variableId&&(n.item&&"Message content"!==n.item||l.set([{id:n.variableId,value:e}]),"Total tokens"===n.item&&l.set([{id:n.variableId,value:t.totalTokens}]))})}catch(e){if(e instanceof eR.w){d.add({status:"error",description:"An API call error occured while generating the response",details:e.message});return}d.add({status:"error",description:"An unknown error occured while generating the response",details:e})}},tp=async e=>{var t,n,o,a;let{credentials:{apiKey:r},options:i,variables:l,config:s,compatibility:d}=e;if(!r)return{httpError:{status:401,message:"API key missing"}};let u=null!==(n=null===(t=i.model)||void 0===t?void 0:t.trim())&&void 0!==n?n:s.defaultModel;if(!u)return{httpError:{status:400,message:"model not found"}};let c={model:(0,ti.JV)({baseURL:null!==(o=s.baseUrl)&&void 0!==o?o:i.baseUrl,apiKey:r,compatibility:d})(u),messages:await q({messages:i.messages,isVisionEnabled:tu(u),shouldDownloadImages:!1,variables:l}),temperature:i.temperature?Number(i.temperature):void 0,tools:eg({tools:i.tools,variables:l})};try{let e=await (0,eE.kP)(c),t=0,n=0,o=[],a=[];return{stream:new ReadableStream({async start(r){var s,d;let u=e.toAIStream().getReader();for(await eL(r,u),n=(await e.usage).totalTokens,(o=await e.toolCalls).length>0&&(a=await e.toolResults);o&&o.length>0&&t<10;){t+=1;let e=await (0,eE.kP)({...c,messages:eA({messages:c.messages,toolCalls:o,toolResults:a})}),i=e.toAIStream().getReader();await eL(r,i),n+=(await e.usage).totalTokens,(o=await e.toolCalls).length>0&&(a=await e.toolResults)}let p=null===(d=i.responseMapping)||void 0===d?void 0:null===(s=d.find(e=>"Total tokens"===e.item))||void 0===s?void 0:s.variableId;p&&await l.set([{id:p,value:n}]),r.close()}})}}catch(e){if(e instanceof eR.w)return{httpError:{status:null!==(a=e.statusCode)&&void 0!==a?a:500,message:e.message}};return{httpError:{status:500,message:"An unknown error occured while generating the response"}}}},tm="https://api.groq.com/openai/v1",tb={type:"encryptedCredentials",name:"Groq account",schema:K.object({apiKey:K.string.layout({label:"API key",isRequired:!0,inputType:"password",helperText:"You can generate an API key [here](https://console.groq.com/keys).",withVariableButton:!1,isDebounceDisabled:!0}),baseUrl:K.string.layout({label:"Base URL",defaultValue:tm,withVariableButton:!1,isDebounceDisabled:!0})})};tr({modelFetchId:"fetchModels",defaultTemperature:1}),async e=>tp({...e,config:{baseUrl:tm}});var tg=n(75769);let th={type:"encryptedCredentials",name:"Mistral account",schema:K.object({apiKey:K.string.layout({label:"API key",isRequired:!0,inputType:"password",helperText:"You can generate an API key [here](https://console.mistral.ai/api-keys).",isDebounceDisabled:!0})})},tv=async e=>{let{credentials:t}=e;if(!(null==t?void 0:t.apiKey))return[];let{data:n}=await F.ZP.get("https://api.mistral.ai/v1/models",{headers:{Authorization:"Bearer ".concat(t.apiKey)}}).json();return n.map(e=>e.id)},tf=async e=>{var t,n;let{credentials:{apiKey:o},options:a,variables:r}=e;if(!o)return{httpError:{status:401,message:"API key missing"}};let i=null===(t=a.model)||void 0===t?void 0:t.trim();if(!i)return{httpError:{status:400,message:"model not found"}};let l={model:(0,tg.fG)({apiKey:o})(i),messages:await q({messages:a.messages,isVisionEnabled:!1,shouldDownloadImages:!1,variables:r}),temperature:a.temperature?Number(a.temperature):void 0,tools:eg({tools:a.tools,variables:r})};try{let e=await (0,eE.kP)(l),t=0,n=[],o=[];return{stream:new ReadableStream({async start(a){let r=e.toAIStream().getReader();for(await eL(a,r),(n=await e.toolCalls).length>0&&(o=await e.toolResults);n&&n.length>0&&t<10;){t+=1;let e=await (0,eE.kP)({...l,messages:eA({messages:l.messages,toolCalls:n,toolResults:o})}),r=e.toAIStream().getReader();await eL(a,r),(n=await e.toolCalls).length>0&&(o=await e.toolResults)}a.close()}})}}catch(e){if(e instanceof eR.w)return{httpError:{status:null!==(n=e.statusCode)&&void 0!==n?n:500,message:e.message}};return{httpError:{status:500,message:"An error occured while generating the stream"}}}},ty={content:K.string.layout({inputType:"textarea",placeholder:"Content"})},tw=K.object({role:K.literal("system")}).extend(ty),tE=K.object({role:K.literal("user")}).extend(ty),tI=K.object({role:K.literal("assistant")}).extend(ty),tx=K.object({role:K.literal("Dialogue"),dialogueVariableId:K.string.layout({inputType:"variableDropdown",placeholder:"Dialogue variable"}),startsBy:K.enum(["user","assistant"]).layout({label:"starts by",direction:"row",defaultValue:"user"})}),tT=(K.object({model:K.string.layout({placeholder:"Select a model",fetcher:"fetchModels"}),messages:K.array(K.discriminatedUnion("role",[tw,tE,tI,tx])).layout({accordion:"Messages",itemLabel:"message",isOrdered:!0}),tools:ew,responseMapping:K.saveResponseArray(["Message content"]).layout({accordion:"Save response"})}),eM({modelFetch:"fetchModels"}),"https://app.nocodb.com"),t_=["Equal to","Not equal","Contains","Greater than","Less than","Is set","Is empty","Starts with","Ends with"],tC={type:"encryptedCredentials",name:"NocoDB account",schema:K.object({baseUrl:K.string.layout({label:"Base URL",isRequired:!0,helperText:"Change it only if you are self-hosting NocoDB.",withVariableButton:!1,defaultValue:tT}).transform(e=>null==e?void 0:e.replace(/\/$/,"")),apiKey:K.string.layout({label:"API Token",isRequired:!0,helperText:"You can generate an API token [here](https://app.nocodb.com/#/account/tokens)",inputType:"password",withVariableButton:!1})})},tS=async e=>{var t;if(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json")){let t=await e.json();return"msg"in t?t.msg:t}return e.text()},tP=e=>{let t={};return e.forEach(e=>{let{key:n,value:o}=e;n&&o&&(t[n]=o)}),t},tN={auth:tC,name:"Create Record",options:K.object({tableId:K.string.layout({label:"Table ID",isRequired:!0,helperText:"Identifier of the table to create records in."}),fields:K.array(K.object({key:K.string.layout({label:"Field",isRequired:!0}),value:K.string.layout({label:"Value",isRequired:!0})})).layout({itemLabel:"field"})}),run:{server:async e=>{let{credentials:{baseUrl:t,apiKey:n},options:{tableId:o,fields:a},logs:r}=e;try{if(!a||0===a.length)return;await F.ZP.post("".concat(null!=t?t:tT,"/api/v2/tables/").concat(o,"/records"),{headers:{"xc-token":n},json:tP(a)})}catch(e){if(e instanceof W.B)return r.add({status:"error",description:e.message,details:await tS(e.response)});console.error(e)}}}},tk=e=>{if(!e||!e.comparisons||0===e.comparisons.length)return;let t=e.comparisons.map(e=>{switch(e.operator){case"Not equal":return"(".concat(e.input,",ne,").concat(e.value,")");case"Contains":return"(".concat(e.input,",like,%").concat(e.value,"%)");case"Greater than":return"(".concat(e.input,",gt,").concat(e.value,")");case"Less than":return"(".concat(e.input,",lt,").concat(e.value,")");case"Is set":return"(".concat(e.input,",isnot,null)");case"Is empty":return"(".concat(e.input,",is,null)");case"Starts with":return"(".concat(e.input,",like,").concat(e.value,"%)");case"Ends with":return"(".concat(e.input,",like,%").concat(e.value,")");default:return"(".concat(e.input,",eq,").concat(e.value,")")}}).filter(Boolean).join("~"+("OR"===e.joiner?"or":"and"));if(!(0,x.xb)(t))return t},tA=e=>Object.entries(e).reduce((e,t)=>{let[n,o]=t;return null==o?e:{...e,[n]:o.toString()}},{}),tL={auth:tC,name:"Search Records",options:K.object({tableId:K.string.layout({label:"Table ID",moreInfoTooltip:"Can be found by clicking on the 3 dots next to the table name.",isRequired:!0}),viewId:K.string.layout({label:"View ID",moreInfoTooltip:"Can be found by clicking on the 3 dots next to the view name."}),returnType:K.enum(["All","First","Last","Random"]).layout({accordion:"Filter",defaultValue:"All"}),filter:K.filter({operators:t_,isJoinerHidden:e=>{let{filter:t}=e;return!(null==t?void 0:t.comparisons)||t.comparisons.length<2}}).layout({accordion:"Filter"}),responseMapping:K.array(K.object({fieldName:K.string.layout({label:"Enter a field name"}),variableId:K.string.layout({inputType:"variableDropdown"})})).layout({accordion:"Response Mapping"})}),getSetVariableIds:e=>{var t;let{responseMapping:n}=e;return null!==(t=null==n?void 0:n.map(e=>e.variableId).filter(x.$K))&&void 0!==t?t:[]},run:{server:async e=>{let{credentials:{baseUrl:t,apiKey:n},options:{tableId:o,responseMapping:a,filter:r,returnType:i,viewId:l},variables:s,logs:d}=e;if(!n)return d.add("API key is required");try{let e;let u=await F.ZP.get("".concat(null!=t?t:tT,"/api/v2/tables/").concat(o,"/records"),{headers:{"xc-token":n},searchParams:tA({where:tk(r),viewId:l,limit:1e3})}).json();if(i&&"All"!==i){let t=u.pageInfo.totalRows;"First"===i?e=0:"Last"===i?e=t-1:"Random"===i&&(e=Math.floor(Math.random()*t))}let c=(0,x.$K)(e)&&u.list[e]?[u.list[e]]:u.list;if(0===c.length)return d.add({status:"info",description:"Couldn't find any rows matching the filter",details:JSON.stringify(r,null,2)});null==a||a.forEach(e=>{if(!e.fieldName||!e.variableId)return;if((0,x.z4)(c[0][e.fieldName])){d.add("Field ".concat(e.fieldName," does not exist in the table"));return}let t=c.map(t=>t[e.fieldName]);s.set([{id:e.variableId,value:1===t.length?t[0]:t}])})}catch(e){if(e instanceof W.B)return d.add({status:"error",description:e.message,details:await tS(e.response)});console.error(e)}}}},tR=(e,t)=>e.map(e=>{let n={Id:e};return t.forEach(e=>{let{fieldName:t,value:o}=e;t&&(n[t]=null!=o?o:null)}),n}),tj={auth:tC,name:"Update Existing Record",options:K.object({tableId:K.string.layout({label:"Table ID",isRequired:!0,moreInfoTooltip:"Can be found by clicking on the 3 dots next to the table name."}),viewId:K.string.layout({label:"View ID",moreInfoTooltip:"Can be found by clicking on the 3 dots next to the view name."}),filter:K.filter({operators:t_,isJoinerHidden:e=>{let{filter:t}=e;return!(null==t?void 0:t.comparisons)||t.comparisons.length<2}}).layout({accordion:"Select Records"}),updates:K.array(K.object({fieldName:K.string.layout({label:"Enter a field name"}),value:K.string.layout({placeholder:"Enter a value"})})).layout({accordion:"Updates"})}),run:{server:async e=>{let{credentials:{baseUrl:t,apiKey:n},options:{tableId:o,filter:a,viewId:r,updates:i},logs:l}=e;if(!n)return l.add("API key is required");if(!i)return l.add("At least one update is required");if(!(null==a?void 0:a.comparisons)||0===a.comparisons.length)return l.add("At least one filter is required");try{let e=await F.ZP.get("".concat(null!=t?t:tT,"/api/v2/tables/").concat(o,"/records"),{headers:{"xc-token":n},searchParams:tA({where:tk(a),viewId:r,limit:1e3})}).json();await F.ZP.patch("".concat(null!=t?t:tT,"/api/v2/tables/").concat(o,"/records"),{headers:{"xc-token":n},json:tR(e.list.map(e=>e.Id),i)})}catch(e){if(e instanceof W.B)return l.add({status:"error",description:e.message,details:await tS(e.response)});console.error(e)}}}},tU={id:"nocodb",name:"NocoDB",docsUrl:"https://docs.typebot.io/forge/blocks/nocodb",tags:["database"],LightLogo:e=>(0,I.jsxs)("svg",{viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,I.jsx)("rect",{width:"32",height:"32",rx:"4",fill:"url(#paint0_linear_1871_109536)"}),(0,I.jsx)("path",{d:"M8.3335 15.1562L12.0047 18.8297V24.6454H8.3335V15.1562ZM23.7533 7.34649V24.0464C23.7533 24.3894 23.4738 24.6665 23.1309 24.6665C22.9665 24.6665 22.8092 24.6031 22.6917 24.4857L8.3335 11.5367V7.8726C8.3335 7.52968 8.61066 7.25253 8.95359 7.25253H8.98648C9.1509 7.25253 9.3106 7.31831 9.42569 7.4334L20.0798 16.6783V7.34649H23.7533Z",fill:"white"}),(0,I.jsx)("defs",{children:(0,I.jsxs)("linearGradient",{id:"paint0_linear_1871_109536",x1:"15.9976",y1:"42.7731",x2:"15.9976",y2:"-8.9707",gradientUnits:"userSpaceOnUse",children:[(0,I.jsx)("stop",{stopColor:"#4351E8"}),(0,I.jsx)("stop",{offset:"1",stopColor:"#2A1EA5"})]})})]}),auth:tC,actions:[tL,tN,tj],onboarding:{youtubeId:"ViKETDQ8Sfg",deployedAt:new Date("2023-06-20")}},tO={type:"encryptedCredentials",name:"OpenRouter account",schema:K.object({apiKey:K.string.layout({label:"API key",isRequired:!0,inputType:"password",helperText:"You can generate an API key [here](https://openrouter.ai/keys).",isDebounceDisabled:!0})})},tz="https://openrouter.ai/api/v1";tr({modelFetchId:"fetchModels",defaultTemperature:1}),async e=>tp({...e,config:{baseUrl:tz}});var tB=n(50995);let tV={type:"encryptedCredentials",name:"OpenAI account",schema:K.object({apiKey:K.string.layout({isRequired:!0,label:"API key",placeholder:"sk-...",inputType:"password",helperText:"You can generate an API key [here](https://platform.openai.com/account/api-keys)",withVariableButton:!1,isDebounceDisabled:!0}),baseUrl:K.string.layout({label:"Base URL",defaultValue:"https://api.openai.com/v1",moreInfoTooltip:"Use a different URL prefix for API calls, e.g. to use proxy servers.",withVariableButton:!1,isDebounceDisabled:!0})})},tM=K.object({baseUrl:K.string.layout({accordion:"Customize provider",label:"Base URL"}),apiVersion:K.string.layout({accordion:"Customize provider",label:"API version"})}).layout({isHidden:!0}).describe("Deprecated, use other dedicated OpenAI compatible blocks instead"),tD=K.object({threadId:K.string.layout({label:"Thread ID",moreInfoTooltip:"Used to remember the conversation with the user. If empty, a new thread is created.",isHidden:!0})}),tK=async e=>{let t=e.split("\n\n"),n=[];for(let e of t){var o,a;if(e.startsWith("http")||e.startsWith('["http'))for(let t of e.startsWith("[")?JSON.parse(e):[e]){let e=t.trim();try{let a=await F.ZP.get(e);a.ok&&(null===(o=a.headers.get("content-type"))||void 0===o?void 0:o.startsWith("image/"))?n.push({type:"image_url",image_url:t.trim()}):n.push({type:"text",text:e})}catch(e){e instanceof W.B?console.log(e.response.status,await e.response.text()):console.error(e)}}else if((null===(a=n.at(-1))||void 0===a?void 0:a.type)==="text"){let t=n.at(-1);(n=n.slice(0,-1)).push({type:"text",text:t.text+"\n\n"+e})}else n.push({type:"text",text:e})}return n},tH=(K.object({assistantId:K.string.layout({label:"Assistant ID",placeholder:"Select an assistant",moreInfoTooltip:"The OpenAI assistant you want to ask question to.",fetcher:"fetchAssistants"}),threadVariableId:K.string.layout({label:"Thread ID",moreInfoTooltip:"Used to remember the conversation with the user. If empty, a new thread is created.",inputType:"variableDropdown"}),message:K.string.layout({label:"Message",inputType:"textarea"}),functions:K.array(K.object({name:K.string.layout({fetcher:"fetchAssistantFunctions",label:"Name"}),code:K.string.layout({inputType:"code",label:"Code",lang:"javascript",moreInfoTooltip:"A javascript code snippet that can use the defined parameters. It should return a value.",withVariableButton:!1})})).layout({accordion:"Functions",itemLabel:"function"}),responseMapping:K.saveResponseArray(["Message","Thread ID"],{item:{hiddenItems:["Thread ID"]}}).layout({accordion:"Save response"})}).merge(tD),async e=>{var t,n;let o,{apiKey:a,assistantId:r,logs:i,message:l,baseUrl:s,apiVersion:d,threadVariableId:u,variables:c,threadId:p,functions:m,responseMapping:b}=e;if((0,x.xb)(r)){null==i||i.add("Assistant ID is empty");return}if((0,x.xb)(l)){null==i||i.add("Message is empty");return}let g=new tB.Pp({apiKey:a,baseURL:s,defaultHeaders:{"api-key":a},defaultQuery:d?{"api-version":d}:void 0});if(u&&(0,x.UE)(null===(t=c.get(u))||void 0===t?void 0:t.toString()))o=null===(n=c.get(u))||void 0===n?void 0:n.toString();else if((0,x.UE)(p))o=p;else{o=(await g.beta.threads.create({})).id;let e=null==b?void 0:b.find(e=>"Thread ID"===e.item);(null==e?void 0:e.variableId)?await c.set([{id:e.variableId,value:o}]):u&&await c.set([{id:u,value:o}])}if(!o){null==i||i.add("Could not get thread ID");return}let h=await g.beta.assistants.retrieve(r),v=await g.beta.threads.messages.create(o,{role:"user",content:tu(h.model)?await tK(l):l});return function(e,t){let{threadId:n,messageId:o}=e;return new ReadableStream({async start(e){let a=new TextEncoder,r=async t=>{let n;for await(let i of t)switch(i.event){case"thread.message.created":e.enqueue(a.encode((0,eX.vl)("assistant_message",{id:i.data.id,role:"assistant",content:[{type:"text",text:{value:""}}]})));break;case"thread.message.delta":{var o,r;let t=null===(o=i.data.delta.content)||void 0===o?void 0:o[0];(null==t?void 0:t.type)==="text"&&(null===(r=t.text)||void 0===r?void 0:r.value)!=null&&e.enqueue(a.encode((0,eX.vl)("text",t.text.value)));break}case"thread.run.completed":case"thread.run.requires_action":n=i.data}return n};e.enqueue(a.encode((0,eX.vl)("assistant_control_data",{threadId:n,messageId:o})));try{await t({threadId:n,messageId:o,sendMessage:t=>{e.enqueue(a.encode((0,eX.vl)("assistant_message",t)))},sendDataMessage:t=>{e.enqueue(a.encode((0,eX.vl)("data_message",t)))},forwardStream:r})}catch(t){var i,l;l=null!==(i=t.message)&&void 0!==i?i:"".concat(t),e.enqueue(a.encode((0,eX.vl)("error",l)))}finally{e.close()}},pull(e){},cancel(){}})}({threadId:o,messageId:v.id},async e=>{var t;let{forwardStream:n}=e;if(!o)return;let a=g.beta.threads.runs.stream(o,{assistant_id:r}),i=await n(a);for(;(null==i?void 0:i.status)==="requires_action"&&(null===(t=i.required_action)||void 0===t?void 0:t.type)==="submit_tool_outputs";){let e=(await Promise.all(i.required_action.submit_tool_outputs.tool_calls.map(async e=>{var t;let n=JSON.parse(e.function.arguments),o=null==m?void 0:m.find(t=>t.name===e.function.name);if(!o||!e.function.name||!o.code)return;let{output:a,newVariables:r}=await eb({variables:c.list(),body:o.code,args:n});return r&&r.length>0&&await c.set(r),{tool_call_id:e.id,output:null!==(t=J(a))&&void 0!==t?t:""}}))).filter(x.$K);i=await n(g.beta.threads.runs.submitToolOutputsStream(o,i.id,{tool_outputs:e}))}})}),tG=async e=>{var t;let{apiKey:n,baseUrl:o,apiVersion:a}=e;if(!n)return[];let r=new tB.ZP({apiKey:n,baseURL:o,defaultHeaders:{"api-key":n},defaultQuery:a?{"api-version":a}:void 0});return null!==(t=(await r.models.list()).data.filter(e=>e.id.includes("gpt")&&!e.id.includes("-audio-")&&!e.id.includes("-realtime-")).sort((e,t)=>t.created-e.created).map(e=>e.id))&&void 0!==t?t:[]};tr({defaultTemperature:td.temperature,modelFetchId:"fetchModels"}),async e=>tp({...e,config:{baseUrl:e.credentials.baseUrl,defaultModel:td.model},compatibility:"strict"});var tF=n(48834).Buffer;K.object({model:K.string.layout({fetcher:"fetchSpeechModels",defaultValue:"tts-1",placeholder:"Select a model"}),input:K.string.layout({label:"Input",inputType:"textarea"}),voice:K.enum(["alloy","echo","fable","onyx","nova","shimmer"]).layout({label:"Voice",placeholder:"Select a voice"}),saveUrlInVariableId:K.string.layout({inputType:"variableDropdown",label:"Save URL in variable"})}),K.object({url:K.string.layout({label:"Audio URL"}),transcriptionVariableId:K.string.layout({label:"Save result to",inputType:"variableDropdown"})}),eM({modelFetch:"fetchModels"}),e=>{let{credentials:t,options:n,variables:o,logs:a}=e;return(null==t?void 0:t.apiKey)===void 0?a.add("No API key provided"):void 0===n.model?a.add("No model provided"):eD({model:(0,ti.JV)({apiKey:t.apiKey,compatibility:"strict"})(n.model),prompt:n.prompt,variablesToExtract:n.variablesToExtract,variables:o,logs:a})};var tW=n(32037);K.object({data:K.string.layout({label:"Data",helperText:"This can be a URL, or any text data you want to encode into a QR code."}),saveUrlInVariableId:K.string.layout({label:"Save QR code image URL",inputType:"variableDropdown"})}),async e=>{let{options:t,variables:n,logs:o}=e;if(!t.data)return o.add("QR code data is empty. Please provide the data to be encoded into the QR code.");if(!t.saveUrlInVariableId)return o.add("QR code image URL is not specified. Please select a variable to save the generated QR code image.");let a=await e3({file:await (0,tW.toBuffer)(t.data),key:"tmp/qrcodes/".concat((0,e1.Mc)()+(0,e1.Mc)(),".png"),mimeType:"image/png"});n.set([{id:t.saveUrlInVariableId,value:a}])};var tX=n(67731);let tq={type:"encryptedCredentials",name:"Segment account",schema:K.object({apiKey:K.string.layout({label:"Write Key",isRequired:!0,inputType:"password",helperText:"You can find your Write Key in your Segment source settings.",withVariableButton:!1,isDebounceDisabled:!0})})},tY=(K.object({userId:K.string.layout({label:"User ID",isRequired:!0,moreInfoTooltip:"New ID of the user."}),previousId:K.string.layout({label:"Previous ID",moreInfoTooltip:"Previous ID of the user to alias."})}),K.object({userId:K.string.layout({label:"User ID",isRequired:!0}),email:K.string.layout({label:"Email",isRequired:!1}),traits:K.array(K.object({key:K.string.layout({label:"Key",isRequired:!0}),value:K.string.layout({label:"Value",isRequired:!0})})).layout({itemLabel:"trait"})}),(e,t)=>{let n={};return e.push({key:"email",value:t}),e.forEach(e=>{let{key:t,value:o}=e;t&&o&&(n[t]=o)}),n}),tZ=(K.object({eventName:K.string.layout({label:"Name",isRequired:!0}),userId:K.string.layout({label:"User ID",isRequired:!0}),properties:K.array(K.object({key:K.string.layout({label:"Key",isRequired:!0}),value:K.string.layout({label:"Value",isRequired:!0})})).layout({itemLabel:"property"})}),e=>{let t={};return e.forEach(e=>{let{key:n,value:o}=e;n&&o&&(t[n]=o)}),t}),tJ=(K.object({userId:K.string.layout({label:"User ID",isRequired:!0}),name:K.string.layout({label:"Name",isRequired:!0}),category:K.string.layout({label:"Category",isRequired:!1}),properties:K.array(K.object({key:K.string.layout({label:"Key",isRequired:!0}),value:K.string.layout({label:"Value",isRequired:!0})})).layout({itemLabel:"property"})}),e=>{let t={};return e.forEach(e=>{let{key:n,value:o}=e;n&&o&&(t[n]=o)}),t}),t$={type:"encryptedCredentials",name:"Together account",schema:K.object({apiKey:K.string.layout({label:"API key",isRequired:!0,inputType:"password",helperText:"You can get your API key [here](https://api.together.xyz/settings/api-keys).",isDebounceDisabled:!0})})},tQ="https://api.together.xyz/v1";tr({modelHelperText:"You can find the list of all the models available [here](https://docs.together.ai/docs/inference-models#chat-models). Copy the model string for API.",defaultTemperature:1}),async e=>tp({...e,config:{baseUrl:tQ}});var t0=n(19126);let t1={type:"encryptedCredentials",name:"Zendesk Conversations API",schema:K.object({conversationsKeyId:K.string.layout({label:"Conversations Key ID",isRequired:!0,withVariableButton:!1,isDebounceDisabled:!0,helperText:"[How to find my Zendesk Key ID and Secret Key?](https://docs.typebot.io/editor/blocks/integrations/zendesk#how-to-find-my-zendesk-key-id-and-secret-key)"}),conversationsSecretKey:K.string.layout({label:"Conversations Secret Key",isRequired:!0,inputType:"password",withVariableButton:!1,isDebounceDisabled:!0})})},t2=(K.object({userId:K.string.layout({label:"User ID"}),name:K.string.layout({label:"Name"}),email:K.string.layout({label:"Email"}),webWidgetKey:K.string.layout({label:"Web Widget Key",helperText:"[Finding web widget key](https://docs.typebot.io/editor/blocks/integrations/zendesk#open-web-widget)"})}),()=>'(function (d, t) {\n    var ZD_URL = "https://static.zdassets.com/ekr/snippet.js?key=" + key;\n\n    var ze_script = d.createElement(t);\n    var s = d.getElementsByTagName(t)[0];\n\n    ze_script.id="ze-snippet";\n    ze_script.src = ZD_URL;\n    ze_script.crossorigin = "anonymous";\n    ze_script.defer = true;\n    ze_script.async = true;\n    s.parentNode.insertBefore(ze_script, s);\n\n    ze_script.onload = function () {\n      if ( isAuthEnabled === "true" && token != "") {\n        zE("messenger", "loginUser", function (callback) {\n          callback(token);\n          zE("messenger", "open");\n        });\n      } else {\n        zE("messenger", "open");\n      }\n    };\n  })(document, "script");\n\n  return "'.concat("Zendesk Web Widget Opened",'"\n  '));tU.id;let t5=e=>Object.values(m).includes(e.type),t3=e=>Object.values(p).includes(e.type),t4=e=>Object.values(g).includes(e.type),t6=e=>e.type===m.CHOICE,t7=e=>Object.values(b).concat(O).includes(e.type),t9=e=>Object.values(p).includes(e);var t8=n(70423);(s=h||(h={})).GET="Get data from sheet",s.INSERT_ROW="Insert a row",s.UPDATE_ROW="Update a row";var ne=n(37794);(d=v||(v={})).OR="OR",d.AND="AND",(u=f||(f={})).EQUAL="Equal to",u.NOT_EQUAL="Not equal",u.CONTAINS="Contains",u.NOT_CONTAINS="Does not contain",u.GREATER="Greater than",u.LESS="Less than",u.IS_SET="Is set",u.IS_EMPTY="Is empty",u.STARTS_WITH="Starts with",u.ENDS_WITH="Ends with",u.MATCHES_REGEX="Matches regex",u.NOT_MATCH_REGEX="Does not match regex";var nt=n(31561);let nn=(e,t)=>{for(let s=0;s<t.length;s++){var n,o,a,r,i,l;for(let d=0;d<(null!==(a=null===(o=t.at(s))||void 0===o?void 0:null===(n=o.blocks)||void 0===n?void 0:n.length)&&void 0!==a?a:0);d++)if((null===(l=t.at(s))||void 0===l?void 0:null===(i=l.blocks)||void 0===i?void 0:null===(r=i.at(d))||void 0===r?void 0:r.id)===e)return{block:t[s].blocks[d],group:t[s],blockIndex:d,groupIndex:s}}throw Error("Block with id ".concat(e," was not found"))};var no=n(51244),na=n(50897),nr=n(35650);let ni={labels:{placeholder:"<strong>\n      Click to upload\n    </strong> or drag and drop<br>\n    (size limit: 10MB)",button:"Upload",clear:"Clear",skip:"Skip",success:{single:"File uploaded",multiple:"{total} files uploaded"}}};(y||(y={})).STRIPE="Stripe";var nl=n(66432);let ns={length:10};(c=w||(w={})).URL="url",c.YOUTUBE="youtube",c.VIMEO="vimeo",c.TIKTOK="tiktok",c.GUMLET="gumlet";var nd=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fieldToParse:"value",escapeForJson:!1};return n=>n&&""!==n?n.replace(/\{\{(.*?)\}\}/g,(n,o)=>{let a=o.replace(/{{|}}/g,""),r=e.find(e=>a===e.name&&("id"===t.fieldToParse||(0,x.$K)(e.value)));if(!r)return"";if("id"===t.fieldToParse)return r.id;let{value:i}=r;return t.escapeForJson?np("string"==typeof i?i:JSON.stringify(i)):nu(i)||""}):""},nu=e=>{if((0,x.z4)(e))return null;if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return console.warn("Failed to safely stringify variable value",e),null}},nc=e=>{if(null===e)return null;if(void 0!==e){if(Array.isArray(e)||"number"==typeof e)return e;if("true"===e)return!0;if("false"===e)return!1;if("null"===e)return null;if("undefined"!==e)try{return JSON.parse(e)}catch(t){return e}}},np=e=>e.replace(/\n/g,"\\n").replace(/"/g,'\\"').replace(/\\[^n"]/g,"\\\\ "),nm=(e,t)=>Object.keys(e).reduce((n,o)=>{let a=e[o];return{...n,[o]:"string"==typeof a?nd(t)(a):a}},{}),nb=(0,U.createContext)({}),ng=e=>{let{children:t,resultId:n,onNewAnswer:o,onVariablesUpdated:a}=e,[r,i]=(0,U.useState)({answers:[],variables:[],createdAt:new Date}),l=e=>{let t=e.map(e=>({...e,value:nu(e.value)}));i(e=>{let n=[...e.variables.filter(e=>t.every(t=>t.id!==e.id||t.name!==e.name)),...t].filter(e=>(0,x.$K)(e.value));return a&&a(n),{...e,variables:n}})};return(0,I.jsx)(nb.Provider,{value:{resultId:n,resultValues:r,addAnswer:e=>t=>{var n,a;return t.variableId&&l([{id:t.variableId,value:t.content,name:null!==(a=null===(n=e.find(e=>e.id===t.variableId))||void 0===n?void 0:n.name)&&void 0!==a?a:""}]),i(e=>({...e,answers:[...e.answers,t]})),o&&o(t)},updateVariables:l},children:t})},nh=()=>(0,U.useContext)(nb),nv=e=>{var t;return null===(t=e.filter(e=>t3(e)||t5(e)).pop())||void 0===t?void 0:t.type},nf=e=>{try{var t;null===(t=window.top)||void 0===t||t.postMessage({from:"typebot",...e},"*")}catch(e){console.error(e)}},ny=(0,U.createContext)({}),nw=e=>{let{children:t,typebot:n,apiHost:o,isPreview:a,isLoading:r,onNewLog:i}=e,[l,s]=(0,U.useState)(n),[d,u]=(0,U.useState)([]),[c,p]=(0,U.useState)(n.typebotId),[m,b]=(0,U.useState)([]),[g,h]=(0,U.useState)([]);(0,U.useEffect)(()=>{s(e=>({...e,theme:n.theme,settings:n.settings}))},[n.theme,n.settings]);let v=(e,t)=>e.map(e=>{var n;let o=t.find(t=>t.name===e.name);return{...e,value:null!==(n=null==o?void 0:o.value)&&void 0!==n?n:e.value}});return(0,I.jsx)(ny.Provider,{value:{typebot:l,linkedTypebots:d,apiHost:o,isPreview:a,updateVariableValue:(e,t)=>{var n,o;let a=nu(t);nf({newVariableValue:{name:null!==(o=null===(n=l.variables.find(t=>t.id===e))||void 0===n?void 0:n.name)&&void 0!==o?o:"",value:null!=a?a:""}});let r=l.variables.find(t=>t.id===e),i=l.variables.filter(t=>t.name===(null==r?void 0:r.name)&&t.id!==e),d=[r,...i].filter(x.$K);s(e=>({...e,variables:e.variables.map(e=>d.some(t=>t.id===e.id)?{...e,value:a}:e)}))},createEdge:e=>{s(t=>({...t,edges:[...t.edges,e]}))},injectLinkedTypebot:e=>{let t=v(e.variables,l.variables),n={id:"typebotId"in e?e.typebotId:e.id,groups:e.groups,edges:e.edges,variables:t};return u(e=>[...e,n]),s({...l,groups:[...l.groups,...n.groups],variables:[...l.variables,...n.variables],edges:[...l.edges,...n.edges]}),n},onNewLog:i,linkedBotQueue:m,isLoading:r,parentTypebotIds:g,pushParentTypebotId:e=>{h(t=>[...t,e])},pushEdgeIdInLinkedTypebotQueue:e=>b(t=>[...t,e]),popEdgeIdFromLinkedTypebotQueue:()=>{b(e=>e.slice(1)),h(e=>e.slice(1)),p(m[0].typebotId)},currentTypebotId:c,setCurrentTypebotId:p},children:t})},nE=()=>(0,U.useContext)(ny),nI={general:{bgImage:"--typebot-container-bg-image",bgColor:"--typebot-container-bg-color",fontFamily:"--typebot-container-font-family"},chat:{hostBubbles:{bgColor:"--typebot-host-bubble-bg-color",color:"--typebot-host-bubble-color"},guestBubbles:{bgColor:"--typebot-guest-bubble-bg-color",color:"--typebot-guest-bubble-color"},inputs:{bgColor:"--typebot-input-bg-color",color:"--typebot-input-color",placeholderColor:"--typebot-input-placeholder-color"},buttons:{bgColor:"--typebot-button-bg-color",color:"--typebot-button-color"}}},nx=(e,t)=>{e&&(e.general&&nT(e.general,t),e.chat&&n_(e.chat,t))},nT=(e,t)=>{let{background:n,font:o}=e;o&&"string"==typeof o&&t.setProperty(nI.general.fontFamily,o)},n_=(e,t)=>{let{hostBubbles:n,guestBubbles:o,buttons:a,inputs:r}=e;n&&nC(n,t),o&&nS(o,t),a&&nP(a,t),r&&nN(r,t)},nC=(e,t)=>{e.backgroundColor&&t.setProperty(nI.chat.hostBubbles.bgColor,e.backgroundColor),e.color&&t.setProperty(nI.chat.hostBubbles.color,e.color)},nS=(e,t)=>{e.backgroundColor&&t.setProperty(nI.chat.guestBubbles.bgColor,e.backgroundColor),e.color&&t.setProperty(nI.chat.guestBubbles.color,e.color)},nP=(e,t)=>{e.backgroundColor&&t.setProperty(nI.chat.buttons.bgColor,e.backgroundColor),e.color&&t.setProperty(nI.chat.buttons.color,e.color)},nN=(e,t)=>{e.backgroundColor&&t.setProperty(nI.chat.inputs.bgColor,e.backgroundColor),e.color&&t.setProperty(nI.chat.inputs.color,e.color),e.placeholderColor&&t.setProperty(nI.chat.inputs.placeholderColor,e.placeholderColor)},nk=(0,U.createContext)({}),nA=e=>{let{children:t,onScroll:n}=e;return(0,I.jsx)(nk.Provider,{value:{scroll:n},children:t})},nL=()=>(0,U.useContext)(nk),nR=window.matchMedia("only screen and (max-width: 760px)").matches,nj=window.parent&&window.location!==(null===(E=window.top)||void 0===E?void 0:E.location),nU=(e,t,n)=>{var o;return{status:e?"error":"success",description:e?n:t,details:null!==(o=e&&JSON.stringify(e,null,2).substring(0,1e3))&&void 0!==o?o:null}},nO=e=>{var t;return'\nwindow.$chatwoot.setUser("'.concat(null!==(t=null==e?void 0:e.id)&&void 0!==t?t:"",'", {\n  email: ').concat((null==e?void 0:e.email)?'"'.concat(e.email,'"'):"undefined",",\n  name: ").concat((null==e?void 0:e.name)?'"'.concat(e.name,'"'):"undefined",",\n  avatar_url: ").concat((null==e?void 0:e.avatarUrl)?'"'.concat(e.avatarUrl,'"'):"undefined",",\n  phone_number: ").concat((null==e?void 0:e.phoneNumber)?'"'.concat(e.phoneNumber,'"'):"undefined",",\n});\n\n")},nz=function(){let{baseUrl:e,websiteToken:t,user:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"\nif (window.$chatwoot) {\n  if(".concat(!!n,") {\n    ").concat(nO(n),'\n  }\n  window.$chatwoot.toggle("open");\n} else {\n  (function (d, t) {\n    var BASE_URL = "').concat(e,'";\n    var g = d.createElement(t),\n      s = d.getElementsByTagName(t)[0];\n    g.src = BASE_URL + "/packs/js/sdk";\n    g.defer = true;\n    g.async = true;\n    s.parentNode.insertBefore(g, s);\n    g.onload = function () {\n      window.chatwootSDK.run({\n        websiteToken: "').concat(t,'",\n        baseUrl: BASE_URL,\n      });\n      window.addEventListener("chatwoot:ready", function () {\n        if(').concat(!!((null==n?void 0:n.id)||(null==n?void 0:n.email)),") {\n          ").concat(nO(n),'\n        }\n        window.$chatwoot.toggle("open");\n      });\n    };\n  })(document, "script");\n}')},nB=(e,t)=>{let{variables:n,isPreview:o,onNewLog:a}=t;if(o)a({status:"info",description:"Chatwoot won't open in preview mode",details:null});else if(nj)nf({closeChatBubble:!0}),nf({codeToExecute:nd(n)(nz(e.options))});else{let t=Function(nd(n)(nz(e.options)));try{t()}catch(e){console.error(e)}}return e.outgoingEdgeId},nV=async(e,t)=>{var o;let{variables:a}=t;if(!(null===(o=e.options)||void 0===o?void 0:o.trackingId))return e.outgoingEdgeId;let{default:r}=await n.e(723).then(n.bind(n,18723));return await r(e.options.trackingId),(0,L.a)(nm(e.options,a)),e.outgoingEdgeId},nM=async(e,t)=>{if(!e.options||!("action"in e.options))return e.outgoingEdgeId;switch(e.options.action){case h.INSERT_ROW:nD(e.options,t);break;case h.UPDATE_ROW:nK(e.options,t);break;case h.GET:await nH(e.options,t)}return e.outgoingEdgeId},nD=(e,t)=>{let{variables:n,apiHost:o,onNewLog:a,resultId:r}=t;if(!e.cellsToInsert){a({status:"warning",description:"Cells to insert are undefined",details:null});return}(0,x.wG)({url:"".concat(o,"/api/integrations/google-sheets/spreadsheets/").concat(e.spreadsheetId,"/sheets/").concat(e.sheetId),method:"POST",body:{action:h.INSERT_ROW,credentialsId:e.credentialsId,resultId:r,values:nG(e.cellsToInsert,n)}}).then(e=>{let{error:t}=e;a(nU(t,"Succesfully inserted a row in the sheet","Failed to insert a row in the sheet"))})},nK=(e,t)=>{var n,o,a;let{variables:r,apiHost:i,onNewLog:l,resultId:s}=t;e.cellsToUpsert&&"referenceCell"in e&&(0,x.wG)({url:"".concat(i,"/api/integrations/google-sheets/spreadsheets/").concat(e.spreadsheetId,"/sheets/").concat(e.sheetId),method:"POST",body:{action:h.UPDATE_ROW,credentialsId:e.credentialsId,values:nG(e.cellsToUpsert,r),resultId:s,referenceCell:{column:null===(n=e.referenceCell)||void 0===n?void 0:n.column,value:nd(r)(null!==(a=null===(o=e.referenceCell)||void 0===o?void 0:o.value)&&void 0!==a?a:"")}}}).then(e=>{let{error:t}=e;l(nU(t,"Succesfully updated a row in the sheet","Failed to update a row in the sheet"))})},nH=async(e,t)=>{var n,o,a,r,i,l;let{variables:s,updateVariableValue:d,updateVariables:u,apiHost:c,onNewLog:p,resultId:m}=t;if(!e.cellsToExtract)return;let{data:b,error:g}=await (0,x.wG)({url:"".concat(c,"/api/integrations/google-sheets/spreadsheets/").concat(e.spreadsheetId,"/sheets/").concat(e.sheetId),method:"POST",body:{action:h.GET,credentialsId:e.credentialsId,referenceCell:"referenceCell"in e?{column:null===(n=e.referenceCell)||void 0===n?void 0:n.column,value:nd(s)(null!==(i=null===(o=e.referenceCell)||void 0===o?void 0:o.value)&&void 0!==i?i:"")}:void 0,filter:e.filter?{comparisons:null===(a=e.filter.comparisons)||void 0===a?void 0:a.map(e=>({...e,value:nd(s)(e.value)})),logicalOperator:null!==(l=null===(r=e.filter)||void 0===r?void 0:r.logicalOperator)&&void 0!==l?l:"AND"}:void 0,columns:e.cellsToExtract.map(e=>e.column),resultId:m}});p(nU(g,"Succesfully fetched data from sheet","Failed to fetch data from sheet")),b&&u(e.cellsToExtract.reduce((e,t)=>{var n,o;let a=s.find((0,x.L7)(t.variableId)),r=b.rows,i=null!==(o=r[Math.floor(Math.random()*r.length)][null!==(n=t.column)&&void 0!==n?n:""])&&void 0!==o?o:null;return a?(d(a.id,i),[...e,{...a,value:i}]):e},[]))},nG=(e,t)=>e.reduce((e,n)=>n.column&&n.value?{...e,[n.column]:nd(t)(n.value)}:e,{}),nF=(e,t)=>{var n,o,a,r,i,l;let{variables:s,apiHost:d,isPreview:u,onNewLog:c,resultId:p,typebotId:m,resultValues:b}=t;if(u)return c({status:"info",description:"Emails are not sent in preview mode",details:null}),e.outgoingEdgeId;let{options:g}=e;return(0,x.wG)({url:"".concat(d,"/api/typebots/").concat(m,"/integrations/email?resultId=").concat(p),method:"POST",body:{credentialsId:null==g?void 0:g.credentialsId,recipients:null==g?void 0:null===(n=g.recipients)||void 0===n?void 0:n.map(nd(s)),subject:nd(s)(null!==(a=null==g?void 0:g.subject)&&void 0!==a?a:""),body:nd(s)(null!==(r=null==g?void 0:g.body)&&void 0!==r?r:""),cc:(null!==(i=null==g?void 0:g.cc)&&void 0!==i?i:[]).map(nd(s)),bcc:(null!==(l=null==g?void 0:g.bcc)&&void 0!==l?l:[]).map(nd(s)),replyTo:(null==g?void 0:g.replyTo)?nd(s)(g.replyTo):void 0,fileUrls:null===(o=s.find((0,x.L7)(null==g?void 0:g.attachmentsVariableId)))||void 0===o?void 0:o.value,isCustomBody:null==g?void 0:g.isCustomBody,isBodyCode:null==g?void 0:g.isBodyCode,resultValues:b}}).then(e=>{let{error:t}=e;c(nU(t,"Succesfully sent an email","Failed to send an email"))}),e.outgoingEdgeId},nW=async(e,t)=>{var n,o;let{blockId:a,variables:r,updateVariableValue:i,updateVariables:l,typebotId:s,apiHost:d,resultValues:u,onNewLog:c,resultId:p,parentTypebotIds:m}=t,b=(0,ne.stringify)({resultId:p}),{data:g,error:h}=await (0,x.wG)({url:"".concat(d,"/api/typebots/").concat(s,"/blocks/").concat(a,"/executeWebhook?").concat(b),method:"POST",body:{variables:r,resultValues:u,parentTypebotIds:m}}),v=null==g?void 0:g.statusCode.toString(),f=!v||(null==v?void 0:v.startsWith("4"))||(null==v?void 0:v.startsWith("5"));c({status:h?"error":f?"warning":"success",description:f?"Webhook returned an error":"Webhook successfuly executed",details:JSON.stringify(null!=h?h:g,null,2).substring(0,1e3)});let y=null===(o=e.options)||void 0===o?void 0:null===(n=o.responseVariableMapping)||void 0===n?void 0:n.reduce((e,t)=>{if(!(null==t?void 0:t.bodyPath)||!t.variableId)return e;let n=r.find((0,x.L7)(t.variableId));if(!n)return e;let o=Function("data","return data.".concat(nd(r)(null==t?void 0:t.bodyPath)));try{let t=o(g);return i(null==n?void 0:n.id,t),[...e,{...n,value:t}]}catch(t){return e}},[]);return y&&l(y),e.outgoingEdgeId},nX=e=>{let{block:t,context:n}=e;switch(t.type){case b.GOOGLE_SHEETS:return nM(t,n);case b.GOOGLE_ANALYTICS:return nV(t,n);case b.ZAPIER:case b.MAKE_COM:case b.PABBLY_CONNECT:case b.HTTP_REQUEST:return nW(t,n);case b.EMAIL:return nF(t,n);case b.CHATWOOT:return nB(t,n);default:return}},nq=(e,t)=>{let{typebot:{variables:n}}=t,o=e.items.find(e=>{var t,o;let{content:a}=e;return(null==a?void 0:a.logicalOperator)===v.AND?null===(t=a.comparisons)||void 0===t?void 0:t.every(nY(n)):null==a?void 0:null===(o=a.comparisons)||void 0===o?void 0:o.some(nY(n))});return o?o.outgoingEdgeId:e.outgoingEdgeId},nY=e=>t=>{var n,o;if(!(null==t?void 0:t.variableId))return!1;let a=(null!==(o=null===(n=e.find(e=>e.id===t.variableId))||void 0===n?void 0:n.value)&&void 0!==o?o:"").toString().trim(),r=nd(e)(t.value).trim();return!(0,x.z4)(r)&&!!t.comparisonOperator&&nZ(a,t.comparisonOperator,r)},nZ=(e,t,n)=>{switch(t){case f.CONTAINS:return e.toLowerCase().includes(n.toLowerCase());case f.EQUAL:return e===n;case f.NOT_EQUAL:return e!==n;case f.GREATER:return Number.parseFloat(e)>Number.parseFloat(n);case f.LESS:return Number.parseFloat(e)<Number.parseFloat(n);case f.IS_SET:return(0,x.$K)(e)&&e.length>0}},nJ=(e,t)=>{var n,o;let{typebot:{variables:a}}=t;if(!(null===(n=e.options)||void 0===n?void 0:n.url))return{nextEdgeId:e.outgoingEdgeId};let r=(0,x.Nm)(nd(a)(e.options.url)),i=window.parent&&window.location!==(null===(o=window.top)||void 0===o?void 0:o.location),l=null;if(i){if(!e.options.isNewTab)return window.top.location.href=r,{nextEdgeId:e.outgoingEdgeId};try{l=window.open(r)}catch(e){nf({redirectUrl:r})}}else l=window.open(r,e.options.isNewTab?"_blank":"_self");return{nextEdgeId:e.outgoingEdgeId,blockedPopupUrl:l?void 0:r}},n$=async(e,t)=>{var n;let{typebot:{variables:o}}=t;if(null===(n=e.options)||void 0===n?void 0:n.content){if(e.options.shouldExecuteInParentContext&&nj)nf({codeToExecute:nd(o)(e.options.content)});else{let t=Function(...o.map(e=>e.id),nd(o,{fieldToParse:"id"})(e.options.content));try{await t(...o.map(e=>nc(e.value)))}catch(e){console.error(e)}}return e.outgoingEdgeId}},nQ=(e,t)=>{var n;let{typebot:{variables:o},updateVariableValue:a,updateVariables:r}=t;if(!(null===(n=e.options)||void 0===n?void 0:n.variableId)||void 0!==e.options.type&&"Custom"!==e.options.type)return e.outgoingEdgeId;let i=e.options.expressionToEvaluate?n0(o)(e.options.expressionToEvaluate):void 0,l=o.find((0,x.L7)(e.options.variableId));return l&&(a(l.id,i),r([{...l,value:i}])),e.outgoingEdgeId},n0=e=>t=>{let n=nd(e,{fieldToParse:"id"})(t.includes("return ")?t:"return ".concat(t));try{return Function(...e.map(e=>e.id),n)(...e.map(e=>nc(e.value)))}catch(n){return nd(e)(t)}},n1=async(e,t)=>{var n,o;let{apiHost:a,injectLinkedTypebot:r,isPreview:i}=t,{data:l,error:s}=i?await (0,x.wG)("/api/typebots/".concat(null===(n=e.options)||void 0===n?void 0:n.typebotId)):await (0,x.wG)("".concat(a,"/api/publicTypebots/").concat(null===(o=e.options)||void 0===o?void 0:o.typebotId));if(!(!l||s))return r(l.typebot)},n2=async(e,t)=>{var n,o,a,r,i;let{typebot:l,linkedTypebots:s,onNewLog:d,createEdge:u,setCurrentTypebotId:c,pushEdgeIdInLinkedTypebotQueue:p,pushParentTypebotId:m,currentTypebotId:b}=t,g=(null===(n=e.options)||void 0===n?void 0:n.typebotId)==="current"?l:null!==(r=[l,...s].find(t=>{var n,o;return"typebotId"in t?t.typebotId===(null===(n=e.options)||void 0===n?void 0:n.typebotId):t.id===(null===(o=e.options)||void 0===o?void 0:o.typebotId)}))&&void 0!==r?r:await n1(e,t);if(!g)return d({status:"error",description:"Failed to link typebot",details:""}),{nextEdgeId:e.outgoingEdgeId};e.outgoingEdgeId&&p({edgeId:e.outgoingEdgeId,typebotId:b}),m(b),c("typebotId"in g?g.typebotId:g.id);let h=null!==(i=null===(o=e.options)||void 0===o?void 0:o.groupId)&&void 0!==i?i:null===(a=g.groups.find(e=>e.blocks.some(e=>"start"===e.type)))||void 0===a?void 0:a.id;if(!h)return{nextEdgeId:e.outgoingEdgeId};let v={id:(1e3*Math.random()).toString(),from:{blockId:""},to:{groupId:h}};return u(v),{nextEdgeId:v.id,linkedTypebot:{...g,edges:[...g.edges,v]}}},n5=async(e,t)=>{var n;let{typebot:{variables:o}}=t;if(!(null===(n=e.options)||void 0===n?void 0:n.secondsToWaitFor))return e.outgoingEdgeId;let a=nd(o)(e.options.secondsToWaitFor);return isNaN(a)||await new Promise(e=>setTimeout(e,1e3*Number.parseInt(a))),e.outgoingEdgeId},n3=async(e,t)=>{switch(e.type){case g.SET_VARIABLE:return{nextEdgeId:nQ(e,t)};case g.CONDITION:return{nextEdgeId:nq(e,t)};case g.REDIRECT:return nJ(e,t);case g.SCRIPT:return{nextEdgeId:await n$(e,t)};case g.TYPEBOT_LINK:return n2(e,t);case g.WAIT:return{nextEdgeId:await n5(e,t)};default:return{}}},n4=e=>(0,I.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"19px",color:"white",...e,children:(0,I.jsx)("path",{d:"M476.59 227.05l-.16-.07L49.35 49.84A23.56 23.56 0 0027.14 52 24.65 24.65 0 0016 72.59v113.29a24 24 0 0019.52 23.57l232.93 43.07a4 4 0 010 7.86L35.53 303.45A24 24 0 0016 327v113.31A23.57 23.57 0 0026.59 460a23.94 23.94 0 0013.22 4 24.55 24.55 0 009.52-1.93L476.4 285.94l.19-.09a32 32 0 000-58.8z"})}),n6=e=>{let{label:t,isDisabled:n,isLoading:o,disableIcon:a,...r}=e;return(0,I.jsxs)("button",{type:"submit",disabled:n||o,...r,className:"py-2 px-4 justify-center font-semibold rounded-md text-white focus:outline-none flex items-center disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100 transition-all filter hover:brightness-90 active:brightness-75 typebot-button "+r.className,children:[o&&(0,I.jsx)(n7,{className:"text-white"}),(0,I.jsx)("span",{className:"xs:flex "+(a?"":"hidden"),children:t}),(0,I.jsx)(n4,{className:"send-icon flex "+(a?"hidden":"xs:hidden")})]})},n7=e=>(0,I.jsxs)("svg",{...e,className:"animate-spin -ml-1 mr-3 h-5 w-5 "+e.className,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","data-testid":"loading-spinner",children:[(0,I.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,I.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n9=U.forwardRef(function(e,t){let{onChange:n,...o}=e;return(0,I.jsx)("input",{ref:t,className:"focus:outline-none bg-transparent px-4 py-4 flex-1 w-full text-input",type:"text",style:{fontSize:"16px"},autoFocus:!nR,onChange:e=>n(e.target.value),...o})}),n8=e=>{var t,n,o,a,r,i;let{block:l,onSubmit:s,defaultValue:d,hasGuestAvatar:u}=e,[c,p]=(0,U.useState)(null!=d?d:""),m=(0,U.useRef)(null),b=()=>{var e;return""!==c&&(null===(e=m.current)||void 0===e?void 0:e.reportValidity())},g=()=>{b()&&s({value:c})};return(0,I.jsxs)("div",{className:"flex items-end justify-between rounded-lg pr-2 typebot-input w-full","data-testid":"input",style:{marginRight:u?"50px":"0.5rem",maxWidth:"350px"},onKeyDown:e=>{"Enter"===e.key&&g()},children:[(0,I.jsx)(n9,{ref:m,value:c,placeholder:null!==(r=null===(n=l.options)||void 0===n?void 0:null===(t=n.labels)||void 0===t?void 0:t.placeholder)&&void 0!==r?r:"Type your email...",onChange:e=>p(e),type:"email",autoComplete:"email"}),(0,I.jsx)(n6,{type:"button",label:null!==(i=null===(a=l.options)||void 0===a?void 0:null===(o=a.labels)||void 0===o?void 0:o.button)&&void 0!==i?i:"Send",isDisabled:""===c,className:"my-2 ml-2",onClick:g})]})},oe=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,ot=e=>oe.test(e),on=e=>{var t,n,o,a,r,i,l;let{block:s,onSubmit:d,defaultValue:u,hasGuestAvatar:c}=e,[p,m]=(0,U.useState)(null!=u?u:""),b=(0,U.useRef)(null),g=()=>{var e;return""!==p&&(null===(e=b.current)||void 0===e?void 0:e.reportValidity())},h=()=>{g()&&d({value:p})};return(0,I.jsxs)("div",{className:"flex items-end justify-between rounded-lg pr-2 typebot-input w-full","data-testid":"input",style:{marginRight:c?"50px":"0.5rem",maxWidth:"350px"},onKeyDown:e=>{"Enter"===e.key&&h()},children:[(0,I.jsx)(nt.ZP,{ref:b,value:p,onChange:e=>m(e),placeholder:null!==(i=null===(n=s.options)||void 0===n?void 0:null===(t=n.labels)||void 0===t?void 0:t.placeholder)&&void 0!==i?i:"Your phone number...",defaultCountry:null===(o=s.options)||void 0===o?void 0:o.defaultCountryCode,autoFocus:!nR}),(0,I.jsx)(n6,{type:"button",label:null!==(l=null===(r=s.options)||void 0===r?void 0:null===(a=r.labels)||void 0===a?void 0:a.button)&&void 0!==l?l:"Send",isDisabled:""===p,className:"my-2 ml-2",onClick:h})]})},oo=e=>(0,nt.tm)(e),oa=e=>{var t,n,o,a,r,i;let{block:l,onSubmit:s,defaultValue:d,hasGuestAvatar:u}=e,[c,p]=(0,U.useState)(null!=d?d:""),m=(0,U.useRef)(null),b=()=>{var e;return""!==c&&(null===(e=m.current)||void 0===e?void 0:e.reportValidity())},g=()=>{b()&&s({value:c})};return(0,I.jsxs)("div",{className:"flex items-end justify-between rounded-lg pr-2 typebot-input w-full","data-testid":"input",style:{marginRight:u?"50px":"0.5rem",maxWidth:"350px"},onKeyDown:e=>{"Enter"===e.key&&g()},children:[(0,I.jsx)(n9,{ref:m,value:c,placeholder:null!==(r=null===(n=l.options)||void 0===n?void 0:null===(t=n.labels)||void 0===t?void 0:t.placeholder)&&void 0!==r?r:"Type your URL...",onChange:e=>{if(!e.startsWith("https://"))return"https:/"===e?void 0:p("https://".concat(e));p(e)},type:"url",autoComplete:"url"}),(0,I.jsx)(n6,{type:"button",label:null!==(i=null===(a=l.options)||void 0===a?void 0:null===(o=a.labels)||void 0===o?void 0:o.button)&&void 0!==i?i:"Send",isDisabled:""===c,className:"my-2 ml-2",onClick:g})]})},or=/^(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})$/,oi=e=>or.test(e),ol=(e,t)=>{switch(t){case m.EMAIL:return ot(e);case m.PHONE:return oo(e);case m.URL:return oi(e)}return!0},os=e=>t5(e)&&(0,x.$K)(e.options)&&"retryMessageContent"in e.options,od=(e,t,n,o)=>{var a;let r=nd(n)(null===(a=e.options)||void 0===a?void 0:a.retryMessageContent),i=e.id+1e3*Math.random(),l={id:(1e3*Math.random()).toString(),from:{blockId:i},to:{groupId:t,blockId:e.id}};return o(l),{id:i,type:p.TEXT,content:{html:"<div>".concat(r,"</div>"),richText:[],plainText:r},outgoingEdgeId:l.id}},ou=e=>{let{url:t,onLinkClick:n}=e;return(0,I.jsxs)("div",{className:"w-full max-w-xs p-4 text-gray-500 bg-white rounded-lg shadow flex flex-col gap-2",role:"alert",children:[(0,I.jsx)("span",{className:"mb-1 text-sm font-semibold text-gray-900",children:"Popup blocked"}),(0,I.jsx)("div",{className:"mb-2 text-sm font-normal",children:"The bot wants to open a new tab but it was blocked by your broswer. It needs a manual approval."}),(0,I.jsx)("a",{href:t,target:"_blank",className:"py-1 px-4 justify-center text-sm font-semibold rounded-md text-white focus:outline-none flex items-center disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100 transition-all filter hover:brightness-90 active:brightness-75 typebot-button",rel:"noreferrer",onClick:n,children:"Continue in new tab"})]})},oc=()=>(0,I.jsx)("figure",{className:"flex justify-center items-center rounded-full text-white w-6 h-6 text-sm relative xs:w-10 xs:h-10 xs:text-xl","data-testid":"default-avatar",children:(0,I.jsxs)("svg",{width:"75",height:"75",viewBox:"0 0 75 75",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"absolute top-0 left-0 w-6 h-6 xs:w-full xs:h-full xs:text-xl",children:[(0,I.jsx)("mask",{id:"mask0",x:"0",y:"0","mask-type":"alpha",children:(0,I.jsx)("circle",{cx:"37.5",cy:"37.5",r:"37.5",fill:"#0042DA"})}),(0,I.jsxs)("g",{mask:"url(#mask0)",children:[(0,I.jsx)("rect",{x:"-30",y:"-43",width:"131",height:"154",fill:"#0042DA"}),(0,I.jsx)("rect",{x:"2.50413",y:"120.333",width:"81.5597",height:"86.4577",rx:"2.5",transform:"rotate(-52.6423 2.50413 120.333)",stroke:"#FED23D",strokeWidth:"5"}),(0,I.jsx)("circle",{cx:"76.5",cy:"-1.5",r:"29",stroke:"#FF8E20",strokeWidth:"5"}),(0,I.jsx)("path",{d:"M-49.8224 22L-15.5 -40.7879L18.8224 22H-49.8224Z",stroke:"#F7F8FF",strokeWidth:"5"})]})]})}),op=e=>{let{avatarSrc:t}=e,[n]=(0,U.useState)(t);return""===n?(0,I.jsx)(I.Fragment,{}):(0,x.$K)(n)?(0,I.jsx)("figure",{className:"flex justify-center items-center rounded-full text-white w-6 h-6 text-sm relative xs:w-10 xs:h-10 xs:text-xl",children:(0,I.jsx)("img",{src:n,alt:"Bot avatar",className:"rounded-full object-cover w-full h-full"})}):(0,I.jsx)(oc,{})},om=(0,U.forwardRef)(function(e,t){let{hostAvatarSrc:n,keepShowing:o}=e,[a,r]=(0,U.useState)(!1),[i,l]=(0,U.useState)(0),s=()=>{if(!d.current||!u.current)return;let{height:e}=d.current.getBoundingClientRect(),{height:t}=u.current.getBoundingClientRect();l(e-t)},d=(0,U.useRef)(null),u=(0,U.useRef)(null);return(0,U.useImperativeHandle)(t,()=>({refreshTopOffset:s})),(0,U.useEffect)(()=>{if(!document)return;r(!0);let e=new nr.do(s);return e.observe(document.body),()=>{e.disconnect()}},[]),(0,I.jsx)("div",{className:"flex w-6 xs:w-10 mr-2 mb-2 flex-shrink-0 items-center relative typebot-avatar-container ",ref:d,children:(0,I.jsx)(na.Z,{classNames:"bubble",timeout:500,in:a&&o,unmountOnExit:!0,children:(0,I.jsx)("div",{className:"absolute w-6 xs:w-10 h-6 xs:h-10 mb-4 xs:mb-2 flex items-center top-0",ref:u,style:{top:"".concat(i,"px"),transition:"top 350ms ease-out, opacity 500ms"},children:(0,I.jsx)(op,{avatarSrc:n})})})})}),ob=e=>{var t,n;let{block:o,onSubmit:a}=e,{typebot:{variables:r}}=nE(),{resultValues:i}=nh(),[l,s]=(0,U.useState)([]),d=e=>t=>{var n;t.preventDefault(),(null===(n=o.options)||void 0===n?void 0:n.isMultipleChoice)?u(e):a({value:nd(r)(o.items[e].content),itemId:o.items[e].id})},u=e=>{let t=l.indexOf(e);-1!==t?(l.splice(t,1),s([...l])):s([...l,e])},c=i&&0===i.answers.length&&1===o.items.length;return(0,I.jsxs)("form",{className:"flex flex-col items-end",onSubmit:()=>a({value:l.map(e=>nd(r)(o.items[e].content)).join(", ")}),children:[(0,I.jsx)("div",{className:"flex flex-wrap justify-end",children:o.items.map((e,t)=>{var n,a;return(0,I.jsxs)("span",{className:"relative inline-flex ml-2 mb-2",children:[(0,I.jsx)("button",{role:(null===(n=o.options)||void 0===n?void 0:n.isMultipleChoice)?"checkbox":"button",onClick:d(t),className:"py-2 px-4 text-left font-semibold rounded-md transition-all filter hover:brightness-90 active:brightness-75 duration-100 focus:outline-none typebot-button "+(!l.includes(t)&&(null===(a=o.options)||void 0===a?void 0:a.isMultipleChoice)?"selectable":""),"data-testid":"button","data-itemid":e.id,children:nd(r)(e.content)}),c&&(0,I.jsxs)("span",{className:"flex h-3 w-3 absolute top-0 right-0 -mt-1 -mr-1 ping",children:[(0,I.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full brightness-225 opacity-75"}),(0,I.jsx)("span",{className:"relative inline-flex rounded-full h-3 w-3 brightness-200"})]})]},e.id)})}),(0,I.jsx)("div",{className:"flex",children:l.length>0&&(0,I.jsx)(n6,{label:null!==(n=null===(t=o.options)||void 0===t?void 0:t.buttonLabel)&&void 0!==n?n:"Send",disableIcon:!0})})]})},og=e=>{let{from:t,to:n,hasTime:o,isRange:a}=e,r=window.navigator.language,i={day:"2-digit",month:"2-digit",year:"numeric",hour:o?"2-digit":void 0,minute:o?"2-digit":void 0},l=new Date(o?t:t.replace(/-/g,"/")).toLocaleString(r,i),s=new Date(o?n:n.replace(/-/g,"/")).toLocaleString(r,i);return"".concat(l).concat(a?" to ".concat(s):"")},oh=e=>{var t,n,o;let{onSubmit:a,options:r}=e,{hasTime:i,isRange:l,labels:s}=null!=r?r:{},[d,u]=(0,U.useState)({from:"",to:""});return(0,I.jsx)("div",{className:"flex flex-col w-full lg:w-4/6",children:(0,I.jsx)("div",{className:"flex items-center",children:(0,I.jsxs)("form",{className:"flex justify-between rounded-lg typebot-input pr-2 items-end",onSubmit:e=>{""===d.from&&""===d.to||(e.preventDefault(),a({value:"".concat(d.from).concat(l?" to ".concat(d.to):""),label:og({...d,hasTime:i,isRange:l})}))},children:[(0,I.jsxs)("div",{className:"flex flex-col",children:[(0,I.jsxs)("div",{className:"flex items-center p-4 "+(l?"pb-0":""),children:[l&&(0,I.jsx)("p",{className:"font-semibold mr-2",children:null!==(t=null==s?void 0:s.from)&&void 0!==t?t:"From:"}),(0,I.jsx)("input",{className:"focus:outline-none flex-1 w-full text-input",style:{minHeight:"2rem",minWidth:"100px",fontSize:"16px"},type:i?"datetime-local":"date",onChange:e=>u({...d,from:e.target.value}),"data-testid":"from-date"})]}),l&&(0,I.jsxs)("div",{className:"flex items-center p-4",children:[l&&(0,I.jsx)("p",{className:"font-semibold",children:null!==(n=null==s?void 0:s.to)&&void 0!==n?n:"To:"}),(0,I.jsx)("input",{className:"focus:outline-none flex-1 w-full text-input ml-2",style:{minHeight:"2rem",minWidth:"100px",fontSize:"16px"},type:i?"datetime-local":"date",onChange:e=>u({...d,to:e.target.value}),"data-testid":"to-date"})]})]}),(0,I.jsx)(n6,{label:null!==(o=null==s?void 0:s.button)&&void 0!==o?o:"Send",isDisabled:""===d.to&&""===d.from,className:"my-2 ml-2"})]})})})},ov=async e=>{let{basePath:t="/api",files:n,onUploadProgress:o}=e,a=[],r=0;for(let{file:e,path:i}of n){o&&o(r/n.length*100),r+=1;let{data:l}=await (0,x.wG)("".concat(t,"/storage/upload-url?filePath=").concat(encodeURIComponent(i),"&fileType=").concat(e.type));if(!(null==l?void 0:l.presignedUrl))continue;let s=l.presignedUrl;if(l.hasReachedStorageLimit)a.push(null);else{if(!(await fetch(s,{method:"PUT",body:e})).ok)continue;a.push(s.split("?")[0])}}return a},of=e=>{var t,n,o,a;let{block:{id:r,options:i},onSubmit:l,onSkip:s}=e,{isMultipleAllowed:d,labels:u,isRequired:c}=null!=i?i:{},p=i&&"sizeLimit"in i?null==i?void 0:i.sizeLimit:void 0,{isPreview:m,currentTypebotId:b}=nE(),{resultId:g}=nh(),[h,v]=(0,U.useState)([]),[f,y]=(0,U.useState)(!1),[w,E]=(0,U.useState)(0),[x,T]=(0,U.useState)(!1),[_,C]=(0,U.useState)(),S=async e=>{e.target.files&&P(e.target.files)},P=e=>{C(void 0);let t=Array.from(e);return t.some(e=>e.size>(null!=p?p:10)*1048576)?C("A file is larger than ".concat(null!=p?p:10,"MB")):!d&&e?k(t[0]):void v([...h,...t])},N=async e=>{e.preventDefault(),0!==h.length&&A(h)},k=async e=>{var t;if(m)return l({label:"File uploaded",value:"http://fake-upload-url.com"});y(!0);let n=await ov({basePath:"/api/typebots/".concat(b,"/blocks/").concat(r),files:[{file:e,path:"public/results/".concat(g,"/").concat(r,"/").concat(e.name)}]});if(y(!1),n.length)return l({label:"File uploaded",value:null!==(t=n[0])&&void 0!==t?t:""});C("An error occured while uploading the file")},A=async e=>{if(m)return l({label:"".concat(e.length," file").concat(e.length>1?"s":""," uploaded"),value:e.map((e,t)=>"http://fake-upload-url.com/".concat(t)).join(", ")});y(!0);let t=await ov({basePath:"/api/typebots/".concat(b,"/blocks/").concat(r),files:e.map(e=>({file:e,path:"public/results/".concat(g,"/").concat(r,"/").concat(e.name)})),onUploadProgress:E});if(y(!1),E(0),t.length!==e.length)return C("An error occured while uploading the files");l({label:"".concat(t.length," file").concat(t.length>1?"s":""," uploaded"),value:t.join(", ")})};return(0,I.jsxs)("form",{className:"flex flex-col w-full",onSubmit:N,children:[(0,I.jsx)("label",{htmlFor:"dropzone-file",className:"typebot-upload-input py-6 flex flex-col justify-center items-center w-full bg-gray-50 rounded-lg border-2 border-gray-300 border-dashed cursor-pointer hover:bg-gray-100 px-8 mb-2 "+(x?"dragging-over":""),onDragOver:e=>{e.preventDefault(),T(!0)},onDragLeave:()=>T(!1),onDrop:e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&P(e.dataTransfer.files)},children:f?(0,I.jsx)(I.Fragment,{children:1===h.length?(0,I.jsx)(n7,{}):(0,I.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,I.jsx)("div",{className:"upload-progress-bar h-2.5 rounded-full",style:{width:"".concat(w>0?w:10,"%"),transition:"width 150ms cubic-bezier(0.4, 0, 0.2, 1)"}})})}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[h.length?(0,I.jsxs)("span",{className:"relative",children:[(0,I.jsx)(ow,{}),(0,I.jsx)("div",{className:"total-files-indicator flex items-center justify-center absolute -right-1 rounded-full px-1 h-4",style:{bottom:"5px"},children:h.length})]}):(0,I.jsx)(oy,{}),(0,I.jsx)("p",{className:"text-sm text-gray-500 text-center",dangerouslySetInnerHTML:{__html:null!==(t=null==u?void 0:u.placeholder)&&void 0!==t?t:""}})]}),(0,I.jsx)("input",{id:"dropzone-file",type:"file",className:"hidden",multiple:d,onChange:S})]})}),0===h.length&&!1===c&&(0,I.jsx)("div",{className:"flex justify-end",children:(0,I.jsx)("button",{className:"py-2 px-4 justify-center font-semibold rounded-md text-white focus:outline-none flex items-center disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100 transition-all filter hover:brightness-90 active:brightness-75 typebot-button ",onClick:s,children:null!==(n=null==u?void 0:u.skip)&&void 0!==n?n:ni.labels.skip})}),d&&h.length>0&&!f&&(0,I.jsx)("div",{className:"flex justify-end",children:(0,I.jsxs)("div",{className:"flex",children:[h.length&&(0,I.jsx)("button",{className:"secondary-button py-2 px-4 justify-center font-semibold rounded-md text-white focus:outline-none flex items-center disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100 transition-all filter hover:brightness-90 active:brightness-75 mr-2",onClick:()=>v([]),children:null!==(o=null==u?void 0:u.clear)&&void 0!==o?o:ni.labels.clear}),(0,I.jsx)(n6,{type:"submit",label:(null==u?void 0:u.button)===ni.labels.button?"".concat(u.button," ").concat(h.length," file").concat(h.length>1?"s":""):null!==(a=null==u?void 0:u.button)&&void 0!==a?a:"",disableIcon:!0})]})}),_&&(0,I.jsx)("p",{className:"text-red-500 text-sm",children:_})]})},oy=()=>(0,I.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mb-3",children:[(0,I.jsx)("polyline",{points:"16 16 12 12 8 16"}),(0,I.jsx)("line",{x1:"12",y1:"12",x2:"12",y2:"21"}),(0,I.jsx)("path",{d:"M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"}),(0,I.jsx)("polyline",{points:"16 16 12 12 8 16"})]}),ow=()=>(0,I.jsxs)("svg",{className:"mb-3",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,I.jsx)("path",{d:"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"}),(0,I.jsx)("polyline",{points:"13 2 13 9 20 9"})]}),oE=e=>{var t,n,o,a,r,i,l,s,d,u;let{block:c,onSubmit:p,defaultValue:m,hasGuestAvatar:b}=e,[g,h]=(0,U.useState)(null!=m?m:""),v=(0,U.useRef)(null),f=()=>{var e;return""!==g&&(null===(e=v.current)||void 0===e?void 0:e.reportValidity())},y=()=>{f()&&p({value:g})};return(0,I.jsxs)("div",{className:"flex items-end justify-between rounded-lg pr-2 typebot-input w-full","data-testid":"input",style:{marginRight:b?"50px":"0.5rem",maxWidth:"350px"},onKeyDown:e=>{"Enter"===e.key&&y()},children:[(0,I.jsx)(n9,{ref:v,value:g,placeholder:null!==(s=null===(n=c.options)||void 0===n?void 0:null===(t=n.labels)||void 0===t?void 0:t.placeholder)&&void 0!==s?s:"Type your answer...",onChange:e=>h(e),type:"number",style:{appearance:"auto"},min:null===(o=c.options)||void 0===o?void 0:o.min,max:null===(a=c.options)||void 0===a?void 0:a.max,step:null!==(d=null===(r=c.options)||void 0===r?void 0:r.step)&&void 0!==d?d:"any"}),(0,I.jsx)(n6,{type:"button",label:null!==(u=null===(l=c.options)||void 0===l?void 0:null===(i=l.labels)||void 0===i?void 0:i.button)&&void 0!==u?u:"Send",isDisabled:""===g,className:"my-2 ml-2",onClick:y})]})},oI=e=>new Promise(t=>{if(e.getElementById("stripe-script"))return t();let n=e.createElement("script");n.src="https://js.stripe.com/v3",n.id="stripe-script",e.body.appendChild(n),n.onload=()=>{t()}}),ox=e=>{let{apiHost:t,isPreview:n,inputOptions:o,variables:a}=e;return(0,x.wG)({url:"".concat(t,"/api/integrations/stripe/createPaymentIntent"),method:"POST",body:{inputOptions:o,isPreview:n,variables:a}})},oT=e=>{let{options:t,onSuccess:n}=e,{apiHost:o,isPreview:a,typebot:{variables:r},onNewLog:i}=nE(),[l,s]=(0,U.useState)(null),[d,u]=(0,U.useState)(""),[c,p]=(0,U.useState)("");return(0,U.useEffect)(()=>{(async()=>{var e;let{data:n,error:l}=await ox({apiHost:o,isPreview:a,variables:r,inputOptions:t});if(l)return i({status:"error",description:l.name+" "+l.message,details:l.message});!n||!document||(await oI(document),(null===(e=window)||void 0===e?void 0:e.Stripe)&&(s(window.Stripe(n.publicKey)),u(n.clientSecret),p(n.amountLabel)))})()},[]),l&&d?(0,I.jsx)(nl.Elements,{stripe:l,options:{clientSecret:d},children:(0,I.jsx)(o_,{onSuccess:n,clientSecret:d,amountLabel:c,options:t,variables:r,viewerHost:o})}):(0,I.jsx)(n7,{className:"text-blue-500"})},o_=e=>{var t;let{onSuccess:n,clientSecret:o,amountLabel:a,options:r,variables:i,viewerHost:l}=e,{scroll:s}=nL(),[d,u]=(0,U.useState)(!0),c=(0,nl.useStripe)(),p=(0,nl.useElements)(),[m,b]=(0,U.useState)(),[g,h]=(0,U.useState)(!1),[v,f]=(0,U.useState)(!1);return(0,U.useEffect)(()=>{if(!(!c||!o)){if(d)return u(!1);c.retrievePaymentIntent(o).then(e=>{let{paymentIntent:t}=e;switch(null==t?void 0:t.status){case"succeeded":b("Payment succeeded!");break;case"processing":b("Your payment is processing.");break;case"requires_payment_method":b("Your payment was not successful, please try again.");break;default:b("Something went wrong.")}})}},[c,o]),(0,I.jsxs)("form",{id:"payment-form",onSubmit:async e=>{var t,o,a,s,d;if(e.preventDefault(),!c||!p)return;h(!0);let{error:u,paymentIntent:m}=await c.confirmPayment({elements:p,confirmParams:{return_url:l,payment_method_data:{billing_details:{name:(null==r?void 0:null===(t=r.additionalInformation)||void 0===t?void 0:t.name)?nd(i)(r.additionalInformation.name):void 0,email:(null==r?void 0:null===(o=r.additionalInformation)||void 0===o?void 0:o.email)?nd(i)(null===(a=r.additionalInformation)||void 0===a?void 0:a.email):void 0,phone:(null==r?void 0:null===(s=r.additionalInformation)||void 0===s?void 0:s.phoneNumber)?nd(i)(null===(d=r.additionalInformation)||void 0===d?void 0:d.phoneNumber):void 0}}},redirect:"if_required"});if(h(!1),(null==u?void 0:u.type)!=="validation_error"){if((null==u?void 0:u.type)==="card_error")return b(u.message);if(!u&&"succeeded"===m.status)return n()}},className:"flex flex-col rounded-lg p-4 typebot-input w-full items-center",children:[(0,I.jsx)(nl.PaymentElement,{id:"payment-element",className:"w-full",onReady:()=>{f(!0),s()}}),v&&(0,I.jsx)(n6,{label:"".concat(null==r?void 0:null===(t=r.labels)||void 0===t?void 0:t.button," ").concat(a),isDisabled:g||!c||!p,isLoading:g,className:"mt-4 w-full max-w-lg",disableIcon:!0}),m&&(0,I.jsx)("div",{id:"payment-message",className:"typebot-input-error-message mt-4 text-center",children:m})]})},oC=e=>{let{onSuccess:t,options:n}=e;switch(null==n?void 0:n.provider){case void 0:case y.STRIPE:return(0,I.jsx)(oT,{onSuccess:t,options:n})}},oS=e=>{var t,n,o,a,r,i,l,s,d,u;let{block:c,onSubmit:p}=e,[m,b]=(0,U.useState)(),g=e=>{var t;(null===(t=c.options)||void 0===t?void 0:t.isOneClickSubmitEnabled)&&p({value:e.toString()}),b(e)};return(0,I.jsxs)("form",{className:"flex flex-col",onSubmit:e=>{e.preventDefault(),(0,x.z4)(m)||p({value:m.toString()})},children:[(null===(n=c.options)||void 0===n?void 0:null===(t=n.labels)||void 0===t?void 0:t.left)&&(0,I.jsx)("span",{className:"text-sm w-full mb-2 rating-label",children:c.options.labels.left}),(0,I.jsx)("div",{className:"flex flex-wrap justify-center",children:Array.from(Array((null!==(d=null===(o=c.options)||void 0===o?void 0:o.length)&&void 0!==d?d:ns.length)+((null===(a=c.options)||void 0===a?void 0:a.buttonType)==="Numbers"?1:0))).map((e,t)=>{var n;return(0,U.createElement)(oP,{...c.options,key:t,rating:m,idx:t+((null===(n=c.options)||void 0===n?void 0:n.buttonType)==="Numbers"?0:1),onClick:g})})}),(null===(i=c.options)||void 0===i?void 0:null===(r=i.labels)||void 0===r?void 0:r.right)&&(0,I.jsx)("span",{className:"text-sm w-full text-right mb-2 pr-2 rating-label",children:c.options.labels.right}),(0,I.jsx)("div",{className:"flex justify-end mr-2",children:(0,x.$K)(m)&&(0,I.jsx)(n6,{label:null!==(u=null===(s=c.options)||void 0===s?void 0:null===(l=s.labels)||void 0===l?void 0:l.button)&&void 0!==u?u:"Send",disableIcon:!0})})]})},oP=e=>{let{rating:t,idx:n,buttonType:o,customIcon:a,onClick:r}=e;return"Numbers"===o?(0,I.jsx)("button",{onClick:e=>{e.preventDefault(),r(n)},className:"py-2 px-4 mr-2 mb-2 text-left font-semibold rounded-md transition-all filter hover:brightness-90 active:brightness-75 duration-100 focus:outline-none typebot-button "+((0,x.$K)(t)&&n<=t?"":"selectable"),children:n}):(0,I.jsx)("div",{className:"flex justify-center items-center rating-icon-container cursor-pointer mr-2 mb-2 "+((0,x.$K)(t)&&n<=t?"selected":""),onClick:()=>r(n),dangerouslySetInnerHTML:{__html:(null==a?void 0:a.isEnabled)&&!(0,x.xb)(a.svg)?a.svg:oN}})},oN='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>',ok=U.forwardRef(function(e,t){let{onChange:n,...o}=e;return(0,I.jsx)("textarea",{ref:t,className:"focus:outline-none bg-transparent px-4 py-4 flex-1 w-full text-input",rows:6,"data-testid":"textarea",required:!0,style:{fontSize:"16px"},autoFocus:!nR,onChange:e=>n(e.target.value),...o})}),oA=e=>{var t,n,o,a,r,i,l,s,d,u;let{block:c,onSubmit:p,defaultValue:m,hasGuestAvatar:b}=e,[g,h]=(0,U.useState)(null!=m?m:""),v=(0,U.useRef)(null),f=null===(t=c.options)||void 0===t?void 0:t.isLong,y=e=>h(e),w=()=>{var e;return""!==g&&(null===(e=v.current)||void 0===e?void 0:e.reportValidity())},E=()=>{w()&&p({value:g})};return(0,I.jsxs)("div",{className:"flex items-end justify-between rounded-lg pr-2 typebot-input w-full","data-testid":"input",style:{marginRight:b?"50px":"0.5rem",maxWidth:f?void 0:"350px"},onKeyDown:e=>{f||"Enter"===e.key&&E()},children:[f?(0,I.jsx)(ok,{ref:v,onChange:y,value:g,placeholder:null!==(s=null===(o=c.options)||void 0===o?void 0:null===(n=o.labels)||void 0===n?void 0:n.placeholder)&&void 0!==s?s:"Type your answer..."}):(0,I.jsx)(n9,{ref:v,onChange:y,value:g,placeholder:null!==(d=null===(r=c.options)||void 0===r?void 0:null===(a=r.labels)||void 0===a?void 0:a.placeholder)&&void 0!==d?d:"Type your answer..."}),(0,I.jsx)(n6,{type:"button",label:null!==(u=null===(l=c.options)||void 0===l?void 0:null===(i=l.labels)||void 0===i?void 0:i.button)&&void 0!==u?u:"Send",isDisabled:""===g,className:"my-2 ml-2",onClick:E})]})},oL=e=>{let{message:t,showAvatar:n,avatarSrc:o}=e,[a]=(0,U.useState)(t);return(0,I.jsx)(na.Z,{classNames:"bubble",timeout:1e3,children:(0,I.jsxs)("div",{className:"flex justify-end mb-2 items-end",style:{marginLeft:"50px"},children:[(0,I.jsx)("span",{className:"px-4 py-2 rounded-lg mr-2 whitespace-pre-wrap max-w-full typebot-guest-bubble cursor-pointer","data-testid":"guest-bubble",children:a}),n&&(0,I.jsx)(op,{avatarSrc:o})]})})},oR=e=>{var t,n,o,a,r,i,l,s,d;let{block:u,hasAvatar:c,hasGuestAvatar:p,onTransitionEnd:b,onSkip:g}=e,{typebot:h,isLoading:v}=nE(),{addAnswer:f}=nh(),[y,w]=(0,U.useState)(),[E,T]=(0,U.useState)(!1),{variableId:_}=null!==(o=u.options)&&void 0!==o?o:{},C=(null!==(a=null===(t=h.settings.general)||void 0===t?void 0:t.isInputPrefillEnabled)&&void 0!==a?a:A.he.general.isInputPrefillEnabled)&&_?null===(n=h.variables.find(e=>{var t;return e.name===(null===(t=h.variables.find((0,x.L7)(_)))||void 0===t?void 0:t.name)}))||void 0===n?void 0:n.value:void 0,S=async e=>{let{label:t,value:n,itemId:o}=e;w(null!=t?t:n);let a=!ol(n,u.type);if(!a&&f){let{group:e}=nn(u.id,h.groups);await f(h.variables)({blockId:u.id,groupId:e.id,content:n,variableId:_,uploadedFiles:u.type===m.FILE})}E||b({label:t,value:n,itemId:o},a),T(!1)};if(v)return null;if(y){let e=null===(i=h.theme.chat)||void 0===i?void 0:null===(r=i.guestAvatar)||void 0===r?void 0:r.url;return(0,I.jsx)(oL,{message:y,showAvatar:null!==(d=null===(s=h.theme.chat)||void 0===s?void 0:null===(l=s.guestAvatar)||void 0===l?void 0:l.isEnabled)&&void 0!==d&&d,avatarSrc:e&&nd(h.variables)(e)})}return(0,I.jsxs)("div",{className:"flex justify-end",children:[c&&(0,I.jsx)("div",{className:"flex w-6 xs:w-10 h-6 xs:h-10 mr-2 mb-2 mt-1 flex-shrink-0 items-center"}),(0,I.jsx)(oj,{block:u,onSubmit:S,onSkip:g,defaultValue:null==C?void 0:C.toString(),hasGuestAvatar:p})]})},oj=e=>{let{block:t,onSubmit:n,onSkip:o,defaultValue:a,hasGuestAvatar:r}=e;switch(t.type){case m.TEXT:return(0,I.jsx)(oA,{block:t,onSubmit:n,defaultValue:a,hasGuestAvatar:r});case m.NUMBER:return(0,I.jsx)(oE,{block:t,onSubmit:n,defaultValue:a,hasGuestAvatar:r});case m.EMAIL:return(0,I.jsx)(n8,{block:t,onSubmit:n,defaultValue:a,hasGuestAvatar:r});case m.URL:return(0,I.jsx)(oa,{block:t,onSubmit:n,defaultValue:a,hasGuestAvatar:r});case m.PHONE:return(0,I.jsx)(on,{block:t,onSubmit:n,defaultValue:a,hasGuestAvatar:r});case m.DATE:return(0,I.jsx)(oh,{options:t.options,onSubmit:n});case m.CHOICE:return(0,I.jsx)(ob,{block:t,onSubmit:n});case m.PAYMENT:return(0,I.jsx)(oC,{options:t.options,onSuccess:()=>{var e,o,a;return n({value:null!==(a=null===(o=t.options)||void 0===o?void 0:null===(e=o.labels)||void 0===e?void 0:e.success)&&void 0!==a?a:"Success"})}});case m.RATING:return(0,I.jsx)(oS,{block:t,onSubmit:n});case m.FILE:return(0,I.jsx)(of,{block:t,onSubmit:n,onSkip:o});default:return null}},oU=()=>(0,I.jsxs)("div",{className:"flex items-center",children:[(0,I.jsx)("div",{className:"w-2 h-2 mr-1 rounded-full bubble1"}),(0,I.jsx)("div",{className:"w-2 h-2 mr-1 rounded-full bubble2"}),(0,I.jsx)("div",{className:"w-2 h-2 rounded-full bubble3"})]}),oO=e=>{let{url:t,onTransitionEnd:n}=e,{typebot:o,isLoading:a}=nE(),r=(0,U.useRef)(null),[i,l]=(0,U.useState)(!0),[s]=(0,U.useState)(nd(o.variables)(t));return(0,U.useEffect)(()=>{if(!i||a)return;let e=setTimeout(()=>{l(!1),setTimeout(()=>{n()},400)},500);return()=>{clearTimeout(e)}},[a,i,n]),(0,I.jsx)("div",{className:"flex flex-col",children:(0,I.jsx)("div",{className:"flex mb-2 w-full lg:w-11/12 items-center",children:(0,I.jsxs)("div",{className:"flex relative z-10 items-start typebot-host-bubble",children:[(0,I.jsx)("div",{className:"flex items-center absolute px-4 py-2 rounded-lg bubble-typing z-10 ",style:{width:i?"4rem":"100%",height:i?"2rem":"100%"},children:i?(0,I.jsx)(oU,{}):null}),(0,I.jsx)("audio",{ref:r,src:s,className:"z-10 content-opacity m-2 "+(i?"opacity-0":"opacity-100"),style:{height:i?"2rem":"revert"},autoPlay:!0,controls:!0})]})})})},oz=e=>{var t,n;let{block:o,onTransitionEnd:a}=e,{typebot:r,isLoading:i}=nE(),l=(0,U.useRef)(null),[s,d]=(0,U.useState)(!0),[u]=(0,U.useState)(nd(r.variables)(null===(t=o.content)||void 0===t?void 0:t.url)),c=(0,U.useCallback)(()=>{d(!1),setTimeout(()=>{a()},400)},[a]);(0,U.useEffect)(()=>{if(!s||i)return;let e=setTimeout(()=>{d(!1),c()},1e3);return()=>{clearTimeout(e)}},[i,s,c]);let p=(null===(n=o.content)||void 0===n?void 0:n.height)?"string"==typeof o.content.height?nd(r.variables)(o.content.height)+"px":o.content.height:"2rem";return(0,I.jsx)("div",{className:"flex flex-col w-full",ref:l,children:(0,I.jsx)("div",{className:"flex mb-2 w-full lg:w-11/12 items-center",children:(0,I.jsxs)("div",{className:"flex relative z-10 items-start typebot-host-bubble w-full",children:[(0,I.jsx)("div",{className:"flex items-center absolute px-4 py-2 rounded-lg bubble-typing z-10 ",style:{width:s?"4rem":"100%",height:s?"2rem":"100%"},children:s?(0,I.jsx)(oU,{}):(0,I.jsx)(I.Fragment,{})}),(0,I.jsx)("iframe",{id:"embed-bubble-content",src:u,className:"w-full z-20 p-4 content-opacity "+(s?"opacity-0":"opacity-100"),style:{height:s?"2rem":p,borderRadius:"15px"}})]})})})},oB=e=>{var t;let{block:n,onTransitionEnd:o}=e,{typebot:a,isLoading:r}=nE(),i=(0,U.useRef)(null),l=(0,U.useRef)(null),[s,d]=(0,U.useState)(!0),[u]=(0,U.useState)(nd(a.variables)(null===(t=n.content)||void 0===t?void 0:t.url)),c=(0,U.useCallback)(()=>{d(!1),setTimeout(()=>{o()},400)},[o]);return(0,U.useEffect)(()=>{if(!s||r)return;let e=setTimeout(()=>{d(!1),c()},5e3);return()=>{clearTimeout(e)}},[r,s,c]),(0,U.useEffect)(()=>{let e=l.current;if(!(!e||r||!s))return e.onload=()=>{d(!1),c()},()=>{e.onload=null}},[r,s,c]),(0,I.jsx)("div",{className:"flex flex-col",ref:i,children:(0,I.jsx)("div",{className:"flex mb-2 w-full lg:w-11/12 items-center",children:(0,I.jsxs)("div",{className:"flex relative z-10 items-start typebot-host-bubble",children:[(0,I.jsx)("div",{className:"flex items-center absolute px-4 py-2 rounded-lg bubble-typing z-10 ",style:{width:s?"4rem":"100%",height:s?"2rem":"100%"},children:s?(0,I.jsx)(oU,{}):null}),(0,I.jsx)("img",{ref:l,src:u,className:"p-4 content-opacity z-10 w-auto rounded-lg "+(s?"opacity-0":"opacity-100"),style:{maxHeight:"32rem",height:s?"2rem":"auto",maxWidth:"100%"},alt:"Bubble image"})]})})})},oV=e=>{var t,n,o,a,r;let{bubbleContent:i,typingSettings:l}=e,s=null!==(n=null===(t=i.match(/(\w+)/g))||void 0===t?void 0:t.length)&&void 0!==n?n:0;0===s&&(s=i.length);let{enabled:d,speed:u,maxDelay:c}={enabled:null!==(o=null==l?void 0:l.enabled)&&void 0!==o?o:A.he.typingEmulation.enabled,speed:null!==(a=null==l?void 0:l.speed)&&void 0!==a?a:A.he.typingEmulation.speed,maxDelay:null!==(r=null==l?void 0:l.maxDelay)&&void 0!==r?r:A.he.typingEmulation.maxDelay},p=d?s/u*6e4:0;return p>1e3*c&&(p=1e3*c),p},oM=e=>{var t,n,o;let{block:a,onTransitionEnd:r}=e,{typebot:i,isLoading:l}=nE(),s=(0,U.useRef)(null),[d,u]=(0,U.useState)(!0),[c]=(0,U.useState)(nd(i.variables)(null===(t=a.content)||void 0===t?void 0:t.html)),m=(0,U.useCallback)(()=>{u(!1),setTimeout(()=>{r()},400)},[r]);return(0,U.useEffect)(()=>{var e,t,n;if(!d||l)return;let o=setTimeout(()=>{m()},oV({bubbleContent:null!==(n=null===(e=a.content)||void 0===e?void 0:e.plainText)&&void 0!==n?n:"",typingSettings:null===(t=i.settings)||void 0===t?void 0:t.typingEmulation}));return()=>{clearTimeout(o)}},[null===(n=a.content)||void 0===n?void 0:n.plainText,l,d,m,null===(o=i.settings)||void 0===o?void 0:o.typingEmulation]),(0,I.jsx)("div",{className:"flex flex-col",ref:s,children:(0,I.jsx)("div",{className:"flex mb-2 w-full items-center",children:(0,I.jsxs)("div",{className:"flex relative items-start typebot-host-bubble",children:[(0,I.jsx)("div",{className:"flex items-center absolute px-4 py-2 rounded-lg bubble-typing ",style:{width:d?"4rem":"100%",height:d?"2rem":"100%"},"data-testid":"host-bubble",children:d?(0,I.jsx)(oU,{}):null}),a.type===p.TEXT&&(0,I.jsx)("p",{style:{textOverflow:"ellipsis"},className:"overflow-hidden content-opacity mx-4 my-2 whitespace-pre-wrap slate-html-container relative "+(d?"opacity-0 h-6":"opacity-100 h-full"),dangerouslySetInnerHTML:{__html:c}})]})})})},oD=e=>{let{block:t,onTransitionEnd:n}=e,{typebot:o,isLoading:a}=nE(),r=(0,U.useRef)(null),[i,l]=(0,U.useState)(!0),s=(0,U.useCallback)(()=>{l(!1),setTimeout(()=>{n()},400)},[n]);return(0,U.useEffect)(()=>{if(!i||a)return;let e=setTimeout(()=>{l(!1),s()},1e3);return()=>{clearTimeout(e)}},[a,i,s]),(0,I.jsx)("div",{className:"flex flex-col",ref:r,children:(0,I.jsx)("div",{className:"flex mb-2 w-full lg:w-11/12 items-center",children:(0,I.jsxs)("div",{className:"flex relative z-10 items-start typebot-host-bubble",children:[(0,I.jsx)("div",{className:"flex items-center absolute px-4 py-2 rounded-lg bubble-typing z-10 ",style:{width:i?"4rem":"100%",height:i?"2rem":"100%"},children:i?(0,I.jsx)(oU,{}):(0,I.jsx)(I.Fragment,{})}),(0,I.jsx)(oK,{content:t.content,isTyping:i,variables:o.variables})]})})})},oK=e=>{let{content:t,isTyping:n,variables:o}=e,[a]=(0,U.useState)(nd(o)(null==t?void 0:t.url));if(!(null==t?void 0:t.type))return(0,I.jsx)(I.Fragment,{});switch(t.type){case w.URL:{let e=window.navigator.vendor.match(/apple/i);return(0,I.jsxs)("video",{controls:!0,className:"p-4 focus:outline-none w-full z-10 content-opacity rounded-md "+(n?"opacity-0":"opacity-100"),style:{height:n?"2rem":"auto",maxHeight:e?"40vh":""},autoPlay:!0,children:[(0,I.jsx)("source",{src:a,type:"video/mp4"}),"Sorry, your browser doesn't support embedded videos."]})}case w.VIMEO:case w.YOUTUBE:{let e=t.type===w.VIMEO?"https://player.vimeo.com/video":"https://www.youtube.com/embed";return(0,I.jsx)("iframe",{src:"".concat(e,"/").concat(t.id),className:"w-full p-4 content-opacity z-10 rounded-md "+(n?"opacity-0":"opacity-100"),height:n?"2rem":"200px",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}}},oH=e=>{let{block:t,onTransitionEnd:n}=e;switch(t.type){case p.TEXT:return(0,I.jsx)(oM,{block:t,onTransitionEnd:n});case p.IMAGE:return(0,I.jsx)(oB,{block:t,onTransitionEnd:n});case p.VIDEO:return(0,I.jsx)(oD,{block:t,onTransitionEnd:n});case p.EMBED:return(0,I.jsx)(oz,{block:t,onTransitionEnd:n});case p.AUDIO:var o;return(0,I.jsx)(oO,{url:null===(o=t.content)||void 0===o?void 0:o.url,onTransitionEnd:n})}},oG=e=>{var t,n;let{blocks:o,startBlockIndex:a,groupTitle:r,onGroupEnd:i,keepShowingHostAvatar:l}=e,{currentTypebotId:s,typebot:d,updateVariableValue:u,createEdge:c,apiHost:p,isPreview:m,parentTypebotIds:b,onNewLog:h,injectLinkedTypebot:v,linkedTypebots:f,setCurrentTypebotId:y,pushEdgeIdInLinkedTypebotQueue:w,pushParentTypebotId:E}=nE(),{resultValues:T,updateVariables:_,resultId:C}=nh(),{scroll:S}=nL(),[P,N]=(0,U.useState)([]),[k,A]=(0,U.useState)([]),[L,R]=(0,U.useState)(),j=e=>{if(N([...P,e]),t3(e)){let t=nv(P);t&&t9(t)?A(k.map((t,n)=>n===k.length-1?{bubbles:[...t.bubbles,e]}:t)):A([...k,{bubbles:[e]}])}t5(e)&&(0===k.length||(0,x.$K)(k[k.length-1].input)?A([...k,{bubbles:[],input:e}]):A(k.map((t,n)=>n===k.length-1?{...t,input:e}:t)))};(0,U.useEffect)(()=>{let e=o[a];e&&j(e)},[]),(0,U.useEffect)(()=>{S(),O()},[P]);let O=async()=>{let e=[...P].pop();if(e){if(t4(e)){var t;let{nextEdgeId:n,linkedTypebot:o,blockedPopupUrl:a}=await n3(e,{isPreview:m,apiHost:p,typebot:d,linkedTypebots:f,updateVariableValue:u,updateVariables:_,injectLinkedTypebot:v,onNewLog:h,createEdge:c,setCurrentTypebotId:y,pushEdgeIdInLinkedTypebotQueue:w,currentTypebotId:s,pushParentTypebotId:E});if(a&&R(a),e.type===g.REDIRECT&&(null===(t=e.options)||void 0===t?void 0:t.isNewTab)===!1)return;n?i({edgeId:n,updatedTypebot:o}):z()}if(t7(e)){let{group:t}=nn(e.id,d.groups),n=await nX({block:e,context:{apiHost:p,typebotId:s,groupId:t.id,blockId:e.id,variables:d.variables,isPreview:m,updateVariableValue:u,updateVariables:_,resultValues:T,groups:d.groups,onNewLog:h,resultId:C,parentTypebotIds:b}});n?i({edgeId:n}):z()}"start"===e.type&&i({edgeId:e.outgoingEdgeId})}},z=(e,t)=>{S();let n=[...P].pop();if(n){var r,l,s;if(t&&os(n)){let{group:e}=nn(n.id,d.groups);return j(od(n,e.id,d.variables,c))}if(t5(n)&&(null===(r=n.options)||void 0===r?void 0:r.variableId)&&e&&u(n.options.variableId,e.value),t6(n)&&!(null===(l=n.options)||void 0===l?void 0:l.isMultipleChoice)){let t=null===(s=n.items.find((0,x.L7)(null==e?void 0:e.itemId)))||void 0===s?void 0:s.outgoingEdgeId;if(t)return i({edgeId:t})}if((null==n?void 0:n.outgoingEdgeId)||P.length===o.length)return i({edgeId:n.outgoingEdgeId})}let p=o[P.length+a];p?j(p):i({})},B=null===(n=d.theme.chat)||void 0===n?void 0:null===(t=n.hostAvatar)||void 0===t?void 0:t.url;return(0,I.jsx)("div",{className:"flex w-full","data-group-name":r,children:(0,I.jsx)("div",{className:"flex flex-col w-full min-w-0",children:k.map((e,t)=>{var n,o,a,r,i,s;return(0,I.jsx)(oF,{displayChunk:e,hostAvatar:{isEnabled:null===(i=null===(o=d.theme.chat)||void 0===o?void 0:null===(n=o.hostAvatar)||void 0===n?void 0:n.isEnabled)||void 0===i||i,src:B&&nd(d.variables)(B)},hasGuestAvatar:null!==(s=null===(r=d.theme.chat)||void 0===r?void 0:null===(a=r.guestAvatar)||void 0===a?void 0:a.isEnabled)&&void 0!==s&&s,onDisplayNextBlock:z,keepShowingHostAvatar:l,blockedPopupUrl:L,onBlockedPopupLinkClick:()=>R(void 0)},t)})})})},oF=e=>{let{displayChunk:{bubbles:t,input:n},hostAvatar:o,hasGuestAvatar:a,keepShowingHostAvatar:r,blockedPopupUrl:i,onBlockedPopupLinkClick:l,onDisplayNextBlock:s}=e,[d,u]=(0,U.useState)(!1),c=(0,U.useRef)();(0,U.useEffect)(()=>{p()});let p=()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.refreshTopOffset()};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{className:"flex",children:[o.isEnabled&&t.length>0&&(0,I.jsx)(om,{ref:c,hostAvatarSrc:o.src,keepShowing:(r||(0,x.$K)(n))&&!d}),(0,I.jsx)("div",{className:"flex-1",style:{marginRight:a?"50px":"0.5rem"},children:(0,I.jsx)(no.Z,{children:t.map(e=>(0,I.jsx)(na.Z,{classNames:"bubble",timeout:500,unmountOnExit:!0,children:(0,I.jsx)(oH,{block:e,onTransitionEnd:()=>{s(),p()}})},e.id))})})]}),!d&&(0,I.jsx)(na.Z,{classNames:"bubble",timeout:500,unmountOnExit:!0,in:(0,x.$K)(n),children:n?(0,I.jsx)(oR,{block:n,onTransitionEnd:s,onSkip:()=>{s(),u(!0)},hasAvatar:o.isEnabled,hasGuestAvatar:a}):(0,I.jsx)("div",{})}),i?(0,I.jsx)("div",{className:"flex justify-end",children:(0,I.jsx)(ou,{url:i,onLinkClick:l})}):null]})},oW=e=>{let{theme:t,predefinedVariables:n,startGroupId:o,onNewGroupVisible:a,onCompleted:r}=e,{typebot:i,updateVariableValue:l,linkedBotQueue:s,popEdgeIdFromLinkedTypebotQueue:d}=nE(),[u,c]=(0,U.useState)([]),{updateVariables:p}=nh(),m=(0,U.useRef)(null),b=(0,U.useRef)(null),[g,h]=(0,U.useState)(!1),v=e=>{let{edgeId:t,updatedTypebot:n,groupId:o}=e,l=null!=n?n:i;if(o){let e=l.groups.find((0,x.L7)(o));return e?(a({id:"edgeId",from:{blockId:"block"},to:{groupId:o}}),c([...u,{group:e,startBlockIndex:0}])):void 0}let p=l.edges.find((0,x.L7)(t));if(!p){if(s.length>0){let e=s[0].edgeId;d(),v({edgeId:e})}return r()}let m=l.groups.find((0,x.L7)(p.to.groupId));if(!m)return r();let b=p.to.blockId?m.blocks.findIndex((0,x.L7)(p.to.blockId)):0;a(p),c([...u,{group:m,startBlockIndex:-1===b?0:b}])};(0,U.useEffect)(()=>{if(g)return;(0,x.$K)(n)&&Object.keys(n).length>0&&p(f(n)),h(!0);let e=i.groups[0].blocks[0].outgoingEdgeId;(e||o)&&v({edgeId:o?void 0:e,groupId:o})},[n]);let f=e=>{let t=[];return Object.keys(e).forEach(n=>{let o=i.variables.find(e=>e.name.toLowerCase()===n.toLowerCase());if(!e||(0,x.z4)(o))return;let a=e[n];a&&(l(null==o?void 0:o.id,a),t.push({...o,value:a}))}),t};return(0,U.useEffect)(()=>{document&&nx(t,document.body.style)},[t]),(0,I.jsxs)("div",{ref:b,className:"overflow-y-scroll w-full lg:w-3/4 min-h-full rounded lg:px-5 px-3 pt-10 relative scrollable-container typebot-chat-view",children:[(0,I.jsx)(nA,{onScroll:()=>{b.current&&setTimeout(()=>{t8.NY.scrollToBottom({duration:500,container:b.current})},1)},children:u.map((e,t)=>{let n=u[t+1],o=n&&t5(n.group.blocks[n.startBlockIndex]);return(0,I.jsx)(oG,{blocks:e.group.blocks,startBlockIndex:e.startBlockIndex,onGroupEnd:v,groupTitle:e.group.title,keepShowingHostAvatar:t===u.length-1||o},e.group.id+t)})}),(0,I.jsx)("div",{className:"w-full h-32",ref:m})]})},oX=()=>{let e=(0,U.useRef)(null);return(0,U.useEffect)(()=>{if(!document)return;let t=document.querySelector('[data-testid="container"]'),n=new MutationObserver(n=>{n.forEach(n=>{n.removedNodes.forEach(n=>{"lite-badge"===n.id&&t.append(e.current)})})});return n.observe(t,{subtree:!1,childList:!0}),()=>{n.disconnect()}},[]),(0,I.jsxs)("a",{ref:e,href:"https://www.typebot.io/?utm_source=litebadge",target:"_blank",rel:"noopener noreferrer",className:"fixed py-1 px-2 bg-white z-50 rounded shadow-md lite-badge",style:{bottom:"20px"},id:"lite-badge",children:["Made with ",(0,I.jsx)("span",{className:"text-blue-500",children:"Typebot"}),"."]})},oq=e=>{var t,n,o,a,r,i,l,s;let{typebot:d,apiHost:u=R.O.NEXT_PUBLIC_VIEWER_URL[0],isPreview:c=!1,isLoading:p=!1,resultId:m,startGroupId:b,predefinedVariables:g,onNewLog:h,onNewGroupVisible:v,onNewAnswer:f,onCompleted:y,onVariablesUpdated:w}=e,E=(0,U.useMemo)(()=>{var e,t,n;return(null==d?void 0:null===(n=d.theme)||void 0===n?void 0:null===(t=n.general)||void 0===t?void 0:null===(e=t.background)||void 0===e?void 0:e.type)===j.Eo.COLOR?d.theme.general.background.content:"transparent"},[null==d?void 0:null===(n=d.theme)||void 0===n?void 0:null===(t=n.general)||void 0===t?void 0:t.background]);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("style",{children:['/* CSS variables. */\n:root {\n  --PhoneInput-color--focus: #03b2cb;\n  --PhoneInputInternationalIconPhone-opacity: 0.8;\n  --PhoneInputInternationalIconGlobe-opacity: 0.65;\n  --PhoneInputCountrySelect-marginRight: 0.35em;\n  --PhoneInputCountrySelectArrow-width: 0.3em;\n  --PhoneInputCountrySelectArrow-marginLeft: var(\n    --PhoneInputCountrySelect-marginRight\n  );\n  --PhoneInputCountrySelectArrow-borderWidth: 1px;\n  --PhoneInputCountrySelectArrow-opacity: 0.45;\n  --PhoneInputCountrySelectArrow-color: currentColor;\n  --PhoneInputCountrySelectArrow-color--focus: var(--PhoneInput-color--focus);\n  --PhoneInputCountrySelectArrow-transform: rotate(45deg);\n  --PhoneInputCountryFlag-aspectRatio: 1.5;\n  --PhoneInputCountryFlag-height: 1em;\n  --PhoneInputCountryFlag-borderWidth: 1px;\n  --PhoneInputCountryFlag-borderColor: rgba(0, 0, 0, 0.5);\n  --PhoneInputCountryFlag-borderColor--focus: var(--PhoneInput-color--focus);\n  --PhoneInputCountryFlag-backgroundColor--loading: rgba(0, 0, 0, 0.1);\n}\n\n.PhoneInput {\n  /* This is done to stretch the contents of this component. */\n  display: flex;\n  align-items: center;\n}\n\n.PhoneInputInput {\n  /* The phone number input stretches to fill all empty space */\n  flex: 1;\n  /* The phone number input should shrink\n	   to make room for the extension input */\n  min-width: 0;\n}\n\n.PhoneInputCountryIcon {\n  width: calc(\n    var(--PhoneInputCountryFlag-height) *\n    var(--PhoneInputCountryFlag-aspectRatio)\n  );\n  height: var(--PhoneInputCountryFlag-height);\n}\n\n.PhoneInputCountryIcon--square {\n  width: var(--PhoneInputCountryFlag-height);\n}\n\n.PhoneInputCountryIcon--border {\n  /* Removed `background-color` because when an `<img/>` was still loading\n	   it would show a dark gray rectangle. */\n  /* For some reason the `<img/>` is not stretched to 100% width and height\n	   and sometime there can be seen white pixels of the background at top and bottom. */\n  background-color: var(--PhoneInputCountryFlag-backgroundColor--loading);\n  /* Border is added via `box-shadow` because `border` interferes with `width`/`height`. */\n  /* For some reason the `<img/>` is not stretched to 100% width and height\n	   and sometime there can be seen white pixels of the background at top and bottom,\n	   so an additional "inset" border is added. */\n  box-shadow: 0 0 0 var(--PhoneInputCountryFlag-borderWidth)\n    var(--PhoneInputCountryFlag-borderColor), inset 0 0 0\n    var(--PhoneInputCountryFlag-borderWidth)\n    var(--PhoneInputCountryFlag-borderColor);\n}\n\n.PhoneInputCountryIconImg {\n  /* Fixes weird vertical space above the flag icon. */\n  /* https://gitlab.com/catamphetamine/react-phone-number-input/-/issues/7#note_348586559 */\n  display: block;\n  /* 3rd party <SVG/> flag icons won\'t stretch if they have `width` and `height`.\n	   Also, if an <SVG/> icon\'s aspect ratio was different, it wouldn\'t fit too. */\n  width: 100%;\n  height: 100%;\n}\n\n.PhoneInputInternationalIconPhone {\n  opacity: var(--PhoneInputInternationalIconPhone-opacity);\n}\n\n.PhoneInputInternationalIconGlobe {\n  opacity: var(--PhoneInputInternationalIconGlobe-opacity);\n}\n\n/* Styling native country `<select/>`. */\n\n.PhoneInputCountry {\n  position: relative;\n  align-self: stretch;\n  display: flex;\n  align-items: center;\n  margin-right: var(--PhoneInputCountrySelect-marginRight);\n}\n\n.PhoneInputCountrySelect {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%;\n  z-index: 1;\n  border: 0;\n  opacity: 0;\n  cursor: pointer;\n}\n\n.PhoneInputCountrySelect[disabled],\n.PhoneInputCountrySelect[readonly] {\n  cursor: default;\n}\n\n.PhoneInputCountrySelectArrow {\n  display: block;\n  content: "";\n  width: var(--PhoneInputCountrySelectArrow-width);\n  height: var(--PhoneInputCountrySelectArrow-width);\n  margin-left: var(--PhoneInputCountrySelectArrow-marginLeft);\n  border-style: solid;\n  border-color: var(--PhoneInputCountrySelectArrow-color);\n  border-top-width: 0;\n  border-bottom-width: var(--PhoneInputCountrySelectArrow-borderWidth);\n  border-left-width: 0;\n  border-right-width: var(--PhoneInputCountrySelectArrow-borderWidth);\n  transform: var(--PhoneInputCountrySelectArrow-transform);\n  opacity: var(--PhoneInputCountrySelectArrow-opacity);\n}\n\n.PhoneInputCountrySelect:focus\n  + .PhoneInputCountryIcon\n  + .PhoneInputCountrySelectArrow {\n  opacity: 1;\n  color: var(--PhoneInputCountrySelectArrow-color--focus);\n}\n\n.PhoneInputCountrySelect:focus + .PhoneInputCountryIcon--border {\n  box-shadow: 0 0 0 var(--PhoneInputCountryFlag-borderWidth)\n    var(--PhoneInputCountryFlag-borderColor--focus), inset 0 0 0\n    var(--PhoneInputCountryFlag-borderWidth)\n    var(--PhoneInputCountryFlag-borderColor--focus);\n}\n\n.PhoneInputCountrySelect:focus\n  + .PhoneInputCountryIcon\n  .PhoneInputInternationalIconGlobe {\n  opacity: 1;\n  color: var(--PhoneInputCountrySelectArrow-color--focus);\n}\n\n.PhoneInputInput {\n  padding: 1rem 0.5rem;\n  outline: none !important;\n  background: transparent;\n  flex: 1 1 0%;\n  width: 100%;\n  font-size: 16px;\n}\n\n.PhoneInputCountry {\n  padding-left: 0.5rem;\n}\n\n.PhoneInputCountryIcon,\n.PhoneInputCountryIconImg {\n  border-radius: 3px;\n}\n\ninput.PhoneInputInput::-moz-placeholder {\n  color: var(--typebot-input-placeholder-color);\n}\n\ninput.PhoneInputInput::placeholder {\n  color: var(--typebot-input-placeholder-color);\n}\n','/*\n! tailwindcss v3.3.3 | MIT License | https://tailwindcss.com\n*//*\n1. Prevent padding and border from affecting element width. (https://github.com/mozdevs/cssremedy/issues/4)\n2. Allow adding a border to an element by just adding a border-width. (https://github.com/tailwindcss/tailwindcss/pull/116)\n*/\n\n*,\n::before,\n::after {\n  box-sizing: border-box; /* 1 */\n  border-width: 0; /* 2 */\n  border-style: solid; /* 2 */\n  border-color: #e5e7eb; /* 2 */\n}\n\n::before,\n::after {\n  --tw-content: \'\';\n}\n\n/*\n1. Use a consistent sensible line-height in all browsers.\n2. Prevent adjustments of font size after orientation changes in iOS.\n3. Use a more readable tab size.\n4. Use the user\'s configured `sans` font-family by default.\n5. Use the user\'s configured `sans` font-feature-settings by default.\n6. Use the user\'s configured `sans` font-variation-settings by default.\n*/\n\nhtml {\n  line-height: 1.5; /* 1 */\n  -webkit-text-size-adjust: 100%; /* 2 */\n  -moz-tab-size: 4; /* 3 */\n  -o-tab-size: 4;\n     tab-size: 4; /* 3 */\n  font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; /* 4 */\n  font-feature-settings: normal; /* 5 */\n  font-variation-settings: normal; /* 6 */\n}\n\n/*\n1. Remove the margin in all browsers.\n2. Inherit line-height from `html` so users can set them as a class directly on the `html` element.\n*/\n\nbody {\n  margin: 0; /* 1 */\n  line-height: inherit; /* 2 */\n}\n\n/*\n1. Add the correct height in Firefox.\n2. Correct the inheritance of border color in Firefox. (https://bugzilla.mozilla.org/show_bug.cgi?id=190655)\n3. Ensure horizontal rules are visible by default.\n*/\n\nhr {\n  height: 0; /* 1 */\n  color: inherit; /* 2 */\n  border-top-width: 1px; /* 3 */\n}\n\n/*\nAdd the correct text decoration in Chrome, Edge, and Safari.\n*/\n\nabbr:where([title]) {\n  -webkit-text-decoration: underline dotted;\n          text-decoration: underline dotted;\n}\n\n/*\nRemove the default font size and weight for headings.\n*/\n\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  font-size: inherit;\n  font-weight: inherit;\n}\n\n/*\nReset links to optimize for opt-in styling instead of opt-out.\n*/\n\na {\n  color: inherit;\n  text-decoration: inherit;\n}\n\n/*\nAdd the correct font weight in Edge and Safari.\n*/\n\nb,\nstrong {\n  font-weight: bolder;\n}\n\n/*\n1. Use the user\'s configured `mono` font family by default.\n2. Correct the odd `em` font sizing in all browsers.\n*/\n\ncode,\nkbd,\nsamp,\npre {\n  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; /* 1 */\n  font-size: 1em; /* 2 */\n}\n\n/*\nAdd the correct font size in all browsers.\n*/\n\nsmall {\n  font-size: 80%;\n}\n\n/*\nPrevent `sub` and `sup` elements from affecting the line height in all browsers.\n*/\n\nsub,\nsup {\n  font-size: 75%;\n  line-height: 0;\n  position: relative;\n  vertical-align: baseline;\n}\n\nsub {\n  bottom: -0.25em;\n}\n\nsup {\n  top: -0.5em;\n}\n\n/*\n1. Remove text indentation from table contents in Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=999088, https://bugs.webkit.org/show_bug.cgi?id=201297)\n2. Correct table border color inheritance in all Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=935729, https://bugs.webkit.org/show_bug.cgi?id=195016)\n3. Remove gaps between table borders by default.\n*/\n\ntable {\n  text-indent: 0; /* 1 */\n  border-color: inherit; /* 2 */\n  border-collapse: collapse; /* 3 */\n}\n\n/*\n1. Change the font styles in all browsers.\n2. Remove the margin in Firefox and Safari.\n3. Remove default padding in all browsers.\n*/\n\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n  font-family: inherit; /* 1 */\n  font-feature-settings: inherit; /* 1 */\n  font-variation-settings: inherit; /* 1 */\n  font-size: 100%; /* 1 */\n  font-weight: inherit; /* 1 */\n  line-height: inherit; /* 1 */\n  color: inherit; /* 1 */\n  margin: 0; /* 2 */\n  padding: 0; /* 3 */\n}\n\n/*\nRemove the inheritance of text transform in Edge and Firefox.\n*/\n\nbutton,\nselect {\n  text-transform: none;\n}\n\n/*\n1. Correct the inability to style clickable types in iOS and Safari.\n2. Remove default button styles.\n*/\n\nbutton,\n[type=\'button\'],\n[type=\'reset\'],\n[type=\'submit\'] {\n  -webkit-appearance: button; /* 1 */\n  background-color: transparent; /* 2 */\n  background-image: none; /* 2 */\n}\n\n/*\nUse the modern Firefox focus style for all focusable elements.\n*/\n\n:-moz-focusring {\n  outline: auto;\n}\n\n/*\nRemove the additional `:invalid` styles in Firefox. (https://github.com/mozilla/gecko-dev/blob/2f9eacd9d3d995c937b4251a5557d95d494c9be1/layout/style/res/forms.css#L728-L737)\n*/\n\n:-moz-ui-invalid {\n  box-shadow: none;\n}\n\n/*\nAdd the correct vertical alignment in Chrome and Firefox.\n*/\n\nprogress {\n  vertical-align: baseline;\n}\n\n/*\nCorrect the cursor style of increment and decrement buttons in Safari.\n*/\n\n::-webkit-inner-spin-button,\n::-webkit-outer-spin-button {\n  height: auto;\n}\n\n/*\n1. Correct the odd appearance in Chrome and Safari.\n2. Correct the outline style in Safari.\n*/\n\n[type=\'search\'] {\n  -webkit-appearance: textfield; /* 1 */\n  outline-offset: -2px; /* 2 */\n}\n\n/*\nRemove the inner padding in Chrome and Safari on macOS.\n*/\n\n::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n\n/*\n1. Correct the inability to style clickable types in iOS and Safari.\n2. Change font properties to `inherit` in Safari.\n*/\n\n::-webkit-file-upload-button {\n  -webkit-appearance: button; /* 1 */\n  font: inherit; /* 2 */\n}\n\n/*\nAdd the correct display in Chrome and Safari.\n*/\n\nsummary {\n  display: list-item;\n}\n\n/*\nRemoves the default spacing and border for appropriate elements.\n*/\n\nblockquote,\ndl,\ndd,\nh1,\nh2,\nh3,\nh4,\nh5,\nh6,\nhr,\nfigure,\np,\npre {\n  margin: 0;\n}\n\nfieldset {\n  margin: 0;\n  padding: 0;\n}\n\nlegend {\n  padding: 0;\n}\n\nol,\nul,\nmenu {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n\n/*\nReset default styling for dialogs.\n*/\ndialog {\n  padding: 0;\n}\n\n/*\nPrevent resizing textareas horizontally by default.\n*/\n\ntextarea {\n  resize: vertical;\n}\n\n/*\n1. Reset the default placeholder opacity in Firefox. (https://github.com/tailwindlabs/tailwindcss/issues/3300)\n2. Set the default placeholder color to the user\'s configured gray 400 color.\n*/\n\ninput::-moz-placeholder, textarea::-moz-placeholder {\n  opacity: 1; /* 1 */\n  color: #9ca3af; /* 2 */\n}\n\ninput::placeholder,\ntextarea::placeholder {\n  opacity: 1; /* 1 */\n  color: #9ca3af; /* 2 */\n}\n\n/*\nSet the default cursor for buttons.\n*/\n\nbutton,\n[role="button"] {\n  cursor: pointer;\n}\n\n/*\nMake sure disabled buttons don\'t get the pointer cursor.\n*/\n:disabled {\n  cursor: default;\n}\n\n/*\n1. Make replaced elements `display: block` by default. (https://github.com/mozdevs/cssremedy/issues/14)\n2. Add `vertical-align: middle` to align replaced elements more sensibly by default. (https://github.com/jensimmons/cssremedy/issues/14#issuecomment-634934210)\n   This can trigger a poorly considered lint error in some tools but is included by design.\n*/\n\nimg,\nsvg,\nvideo,\ncanvas,\naudio,\niframe,\nembed,\nobject {\n  display: block; /* 1 */\n  vertical-align: middle; /* 2 */\n}\n\n/*\nConstrain images and videos to the parent width and preserve their intrinsic aspect ratio. (https://github.com/mozdevs/cssremedy/issues/14)\n*/\n\nimg,\nvideo {\n  max-width: 100%;\n  height: auto;\n}\n\n/* Make elements with the HTML hidden attribute stay hidden by default */\n[hidden] {\n  display: none;\n}\n\n*, ::before, ::after {\n  --tw-border-spacing-x: 0;\n  --tw-border-spacing-y: 0;\n  --tw-translate-x: 0;\n  --tw-translate-y: 0;\n  --tw-rotate: 0;\n  --tw-skew-x: 0;\n  --tw-skew-y: 0;\n  --tw-scale-x: 1;\n  --tw-scale-y: 1;\n  --tw-pan-x:  ;\n  --tw-pan-y:  ;\n  --tw-pinch-zoom:  ;\n  --tw-scroll-snap-strictness: proximity;\n  --tw-gradient-from-position:  ;\n  --tw-gradient-via-position:  ;\n  --tw-gradient-to-position:  ;\n  --tw-ordinal:  ;\n  --tw-slashed-zero:  ;\n  --tw-numeric-figure:  ;\n  --tw-numeric-spacing:  ;\n  --tw-numeric-fraction:  ;\n  --tw-ring-inset:  ;\n  --tw-ring-offset-width: 0px;\n  --tw-ring-offset-color: #fff;\n  --tw-ring-color: rgb(59 130 246 / 0.5);\n  --tw-ring-offset-shadow: 0 0 #0000;\n  --tw-ring-shadow: 0 0 #0000;\n  --tw-shadow: 0 0 #0000;\n  --tw-shadow-colored: 0 0 #0000;\n  --tw-blur:  ;\n  --tw-brightness:  ;\n  --tw-contrast:  ;\n  --tw-grayscale:  ;\n  --tw-hue-rotate:  ;\n  --tw-invert:  ;\n  --tw-saturate:  ;\n  --tw-sepia:  ;\n  --tw-drop-shadow:  ;\n  --tw-backdrop-blur:  ;\n  --tw-backdrop-brightness:  ;\n  --tw-backdrop-contrast:  ;\n  --tw-backdrop-grayscale:  ;\n  --tw-backdrop-hue-rotate:  ;\n  --tw-backdrop-invert:  ;\n  --tw-backdrop-opacity:  ;\n  --tw-backdrop-saturate:  ;\n  --tw-backdrop-sepia:  ;\n}\n\n::backdrop {\n  --tw-border-spacing-x: 0;\n  --tw-border-spacing-y: 0;\n  --tw-translate-x: 0;\n  --tw-translate-y: 0;\n  --tw-rotate: 0;\n  --tw-skew-x: 0;\n  --tw-skew-y: 0;\n  --tw-scale-x: 1;\n  --tw-scale-y: 1;\n  --tw-pan-x:  ;\n  --tw-pan-y:  ;\n  --tw-pinch-zoom:  ;\n  --tw-scroll-snap-strictness: proximity;\n  --tw-gradient-from-position:  ;\n  --tw-gradient-via-position:  ;\n  --tw-gradient-to-position:  ;\n  --tw-ordinal:  ;\n  --tw-slashed-zero:  ;\n  --tw-numeric-figure:  ;\n  --tw-numeric-spacing:  ;\n  --tw-numeric-fraction:  ;\n  --tw-ring-inset:  ;\n  --tw-ring-offset-width: 0px;\n  --tw-ring-offset-color: #fff;\n  --tw-ring-color: rgb(59 130 246 / 0.5);\n  --tw-ring-offset-shadow: 0 0 #0000;\n  --tw-ring-shadow: 0 0 #0000;\n  --tw-shadow: 0 0 #0000;\n  --tw-shadow-colored: 0 0 #0000;\n  --tw-blur:  ;\n  --tw-brightness:  ;\n  --tw-contrast:  ;\n  --tw-grayscale:  ;\n  --tw-hue-rotate:  ;\n  --tw-invert:  ;\n  --tw-saturate:  ;\n  --tw-sepia:  ;\n  --tw-drop-shadow:  ;\n  --tw-backdrop-blur:  ;\n  --tw-backdrop-brightness:  ;\n  --tw-backdrop-contrast:  ;\n  --tw-backdrop-grayscale:  ;\n  --tw-backdrop-hue-rotate:  ;\n  --tw-backdrop-invert:  ;\n  --tw-backdrop-opacity:  ;\n  --tw-backdrop-saturate:  ;\n  --tw-backdrop-sepia:  ;\n}\n.container {\n  width: 100%;\n}\n@media (min-width: 400px) {\n\n  .container {\n    max-width: 400px;\n  }\n}\n@media (min-width: 640px) {\n\n  .container {\n    max-width: 640px;\n  }\n}\n@media (min-width: 768px) {\n\n  .container {\n    max-width: 768px;\n  }\n}\n@media (min-width: 1024px) {\n\n  .container {\n    max-width: 1024px;\n  }\n}\n@media (min-width: 1280px) {\n\n  .container {\n    max-width: 1280px;\n  }\n}\n@media (min-width: 1536px) {\n\n  .container {\n    max-width: 1536px;\n  }\n}\n.fixed {\n  position: fixed;\n}\n.absolute {\n  position: absolute;\n}\n.relative {\n  position: relative;\n}\n.-right-1 {\n  right: -0.25rem;\n}\n.left-0 {\n  left: 0px;\n}\n.right-0 {\n  right: 0px;\n}\n.top-0 {\n  top: 0px;\n}\n.z-10 {\n  z-index: 10;\n}\n.z-20 {\n  z-index: 20;\n}\n.z-50 {\n  z-index: 50;\n}\n.m-2 {\n  margin: 0.5rem;\n}\n.mx-4 {\n  margin-left: 1rem;\n  margin-right: 1rem;\n}\n.my-2 {\n  margin-top: 0.5rem;\n  margin-bottom: 0.5rem;\n}\n.-ml-1 {\n  margin-left: -0.25rem;\n}\n.-mr-1 {\n  margin-right: -0.25rem;\n}\n.-mt-1 {\n  margin-top: -0.25rem;\n}\n.mb-1 {\n  margin-bottom: 0.25rem;\n}\n.mb-2 {\n  margin-bottom: 0.5rem;\n}\n.mb-3 {\n  margin-bottom: 0.75rem;\n}\n.mb-4 {\n  margin-bottom: 1rem;\n}\n.ml-2 {\n  margin-left: 0.5rem;\n}\n.mr-1 {\n  margin-right: 0.25rem;\n}\n.mr-2 {\n  margin-right: 0.5rem;\n}\n.mr-3 {\n  margin-right: 0.75rem;\n}\n.mt-1 {\n  margin-top: 0.25rem;\n}\n.mt-4 {\n  margin-top: 1rem;\n}\n.\\!block {\n  display: block !important;\n}\n.block {\n  display: block;\n}\n.inline {\n  display: inline;\n}\n.flex {\n  display: flex;\n}\n.inline-flex {\n  display: inline-flex;\n}\n.hidden {\n  display: none;\n}\n.h-2 {\n  height: 0.5rem;\n}\n.h-2\\.5 {\n  height: 0.625rem;\n}\n.h-3 {\n  height: 0.75rem;\n}\n.h-32 {\n  height: 8rem;\n}\n.h-4 {\n  height: 1rem;\n}\n.h-5 {\n  height: 1.25rem;\n}\n.h-6 {\n  height: 1.5rem;\n}\n.h-full {\n  height: 100%;\n}\n.h-screen {\n  height: 100vh;\n}\n.min-h-full {\n  min-height: 100%;\n}\n.w-2 {\n  width: 0.5rem;\n}\n.w-3 {\n  width: 0.75rem;\n}\n.w-5 {\n  width: 1.25rem;\n}\n.w-6 {\n  width: 1.5rem;\n}\n.w-auto {\n  width: auto;\n}\n.w-full {\n  width: 100%;\n}\n.w-screen {\n  width: 100vw;\n}\n.min-w-0 {\n  min-width: 0px;\n}\n.max-w-full {\n  max-width: 100%;\n}\n.max-w-lg {\n  max-width: 32rem;\n}\n.max-w-xs {\n  max-width: 20rem;\n}\n.flex-1 {\n  flex: 1 1 0%;\n}\n.flex-shrink-0 {\n  flex-shrink: 0;\n}\n.transform {\n  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n}\n@keyframes ping {\n\n  75%, 100% {\n    transform: scale(2);\n    opacity: 0;\n  }\n}\n.animate-ping {\n  animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;\n}\n@keyframes spin {\n\n  to {\n    transform: rotate(360deg);\n  }\n}\n.animate-spin {\n  animation: spin 1s linear infinite;\n}\n.cursor-pointer {\n  cursor: pointer;\n}\n.flex-col {\n  flex-direction: column;\n}\n.flex-wrap {\n  flex-wrap: wrap;\n}\n.items-start {\n  align-items: flex-start;\n}\n.items-end {\n  align-items: flex-end;\n}\n.items-center {\n  align-items: center;\n}\n.justify-end {\n  justify-content: flex-end;\n}\n.justify-center {\n  justify-content: center;\n}\n.justify-between {\n  justify-content: space-between;\n}\n.gap-2 {\n  gap: 0.5rem;\n}\n.overflow-hidden {\n  overflow: hidden;\n}\n.overflow-y-scroll {\n  overflow-y: scroll;\n}\n.whitespace-pre-wrap {\n  white-space: pre-wrap;\n}\n.rounded {\n  border-radius: 0.25rem;\n}\n.rounded-full {\n  border-radius: 9999px;\n}\n.rounded-lg {\n  border-radius: 0.5rem;\n}\n.rounded-md {\n  border-radius: 0.375rem;\n}\n.border-2 {\n  border-width: 2px;\n}\n.border-dashed {\n  border-style: dashed;\n}\n.border-gray-300 {\n  --tw-border-opacity: 1;\n  border-color: rgb(209 213 219 / var(--tw-border-opacity));\n}\n.bg-gray-200 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(229 231 235 / var(--tw-bg-opacity));\n}\n.bg-gray-50 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(249 250 251 / var(--tw-bg-opacity));\n}\n.bg-transparent {\n  background-color: transparent;\n}\n.bg-white {\n  --tw-bg-opacity: 1;\n  background-color: rgb(255 255 255 / var(--tw-bg-opacity));\n}\n.bg-cover {\n  background-size: cover;\n}\n.object-cover {\n  -o-object-fit: cover;\n     object-fit: cover;\n}\n.p-4 {\n  padding: 1rem;\n}\n.px-1 {\n  padding-left: 0.25rem;\n  padding-right: 0.25rem;\n}\n.px-2 {\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n}\n.px-3 {\n  padding-left: 0.75rem;\n  padding-right: 0.75rem;\n}\n.px-4 {\n  padding-left: 1rem;\n  padding-right: 1rem;\n}\n.px-8 {\n  padding-left: 2rem;\n  padding-right: 2rem;\n}\n.py-1 {\n  padding-top: 0.25rem;\n  padding-bottom: 0.25rem;\n}\n.py-2 {\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n}\n.py-4 {\n  padding-top: 1rem;\n  padding-bottom: 1rem;\n}\n.py-6 {\n  padding-top: 1.5rem;\n  padding-bottom: 1.5rem;\n}\n.pb-0 {\n  padding-bottom: 0px;\n}\n.pr-2 {\n  padding-right: 0.5rem;\n}\n.pt-10 {\n  padding-top: 2.5rem;\n}\n.text-left {\n  text-align: left;\n}\n.text-center {\n  text-align: center;\n}\n.text-right {\n  text-align: right;\n}\n.text-base {\n  font-size: 1rem;\n  line-height: 1.5rem;\n}\n.text-sm {\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n}\n.font-normal {\n  font-weight: 400;\n}\n.font-semibold {\n  font-weight: 600;\n}\n.text-blue-500 {\n  --tw-text-opacity: 1;\n  color: rgb(59 130 246 / var(--tw-text-opacity));\n}\n.text-gray-500 {\n  --tw-text-opacity: 1;\n  color: rgb(107 114 128 / var(--tw-text-opacity));\n}\n.text-gray-900 {\n  --tw-text-opacity: 1;\n  color: rgb(17 24 39 / var(--tw-text-opacity));\n}\n.text-red-500 {\n  --tw-text-opacity: 1;\n  color: rgb(239 68 68 / var(--tw-text-opacity));\n}\n.text-white {\n  --tw-text-opacity: 1;\n  color: rgb(255 255 255 / var(--tw-text-opacity));\n}\n.opacity-0 {\n  opacity: 0;\n}\n.opacity-100 {\n  opacity: 1;\n}\n.opacity-25 {\n  opacity: 0.25;\n}\n.opacity-75 {\n  opacity: 0.75;\n}\n.shadow {\n  --tw-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);\n  --tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.shadow-md {\n  --tw-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);\n  --tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.brightness-200 {\n  --tw-brightness: brightness(2);\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n.brightness-225 {\n  --tw-brightness: brightness(2.25);\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n.filter {\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n.transition {\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n.transition-all {\n  transition-property: all;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n.duration-100 {\n  transition-duration: 100ms;\n}\n\n:root {\n  --typebot-container-bg-image: none;\n  --typebot-container-bg-color: transparent;\n  --typebot-container-font-family: "Open Sans";\n\n  --typebot-button-bg-color: #0042da;\n  --typebot-button-color: #ffffff;\n\n  --typebot-host-bubble-bg-color: #f7f8ff;\n  --typebot-host-bubble-color: #303235;\n\n  --typebot-guest-bubble-bg-color: #ff8e21;\n  --typebot-guest-bubble-color: #ffffff;\n\n  --typebot-input-bg-color: #ffffff;\n  --typebot-input-color: #303235;\n  --typebot-input-placeholder-color: #9095a0;\n\n  --typebot-header-bg-color: #ffffff;\n  --typebot-header-color: #303235;\n\n  /* Phone input */\n  --PhoneInputCountryFlag-borderColor: transparent;\n  --PhoneInput-color--focus: transparent;\n}\n\n/* Hide scrollbar for Chrome, Safari and Opera */\n.scrollable-container::-webkit-scrollbar {\n  display: none;\n}\n\n/* Hide scrollbar for IE, Edge and Firefox */\n.scrollable-container {\n  -ms-overflow-style: none; /* IE and Edge */\n  scrollbar-width: none; /* Firefox */\n}\n\n/* Transitions */\n.bubble-enter {\n  opacity: 0;\n}\n.bubble-enter-active {\n  opacity: 1;\n  transition-property: opacity;\n  transition-duration: 500ms;\n  transition-timing-function: ease-out;\n}\n.bubble-exit {\n  opacity: 1;\n}\n.bubble-exit-active {\n  opacity: 0;\n  transition-delay: 0ms !important;\n  transition-property: opacity;\n  transition-duration: 400ms;\n  transition-timing-function: ease-out;\n}\n\n.bubble-typing {\n  transition: width 400ms ease-out, height 400ms ease-out;\n}\n\n.content-opacity {\n  transition: opacity 400ms ease-in 200ms;\n}\n\n.bubble1,\n.bubble2,\n.bubble3 {\n  background-color: var(--typebot-host-bubble-color);\n  opacity: 0.5;\n}\n\n.bubble1 {\n  animation: chatBubbles 1s ease-in-out infinite;\n}\n\n.bubble2 {\n  animation: chatBubbles 1s ease-in-out infinite;\n  animation-delay: 0.3s;\n}\n\n.bubble3 {\n  animation: chatBubbles 1s ease-in-out infinite;\n  animation-delay: 0.5s;\n}\n\n@keyframes chatBubbles {\n  0% {\n    transform: translateY(0);\n  }\n  50% {\n    transform: translateY(-5px);\n  }\n  100% {\n    transform: translateY(0);\n  }\n}\n\nbutton,\ninput,\ntextarea {\n  font-weight: 300;\n}\n\n.slate-a {\n  text-decoration: underline;\n}\n\n.slate-html-container > div {\n  min-height: 24px;\n}\n\n.slate-bold {\n  font-weight: bold;\n}\n\n.slate-italic {\n  font-style: oblique;\n}\n\n.slate-underline {\n  text-decoration: underline;\n}\n.text-input::-moz-placeholder {\n  color: var(--typebot-input-placeholder-color) !important;\n  opacity: 1 !important;\n}\n.text-input::placeholder {\n  color: var(--typebot-input-placeholder-color) !important;\n  opacity: 1 !important;\n}\n\n.typebot-container {\n  background-image: var(--typebot-container-bg-image);\n  background-color: var(--typebot-container-bg-color);\n  font-family: var(--typebot-container-font-family);\n}\n\n.custom-header {\n  color: var(--typebot-header-color);\n  background-color: var(--typebot-header-bg-color);\n}\n\n.typebot-button {\n  color: var(--typebot-button-color);\n  background-color: var(--typebot-button-bg-color);\n  border: 1px solid var(--typebot-button-bg-color);\n}\n\n.typebot-button.selectable {\n  color: var(--typebot-host-bubble-color);\n  background-color: var(--typebot-host-bubble-bg-color);\n  border: 1px solid var(--typebot-button-bg-color);\n}\n\n.typebot-host-bubble {\n  color: var(--typebot-host-bubble-color);\n}\n\n.typebot-host-bubble > .bubble-typing {\n  background-color: var(--typebot-host-bubble-bg-color);\n  border: var(--typebot-host-bubble-border);\n}\n\n.typebot-guest-bubble {\n  color: var(--typebot-guest-bubble-color);\n  background-color: var(--typebot-guest-bubble-bg-color);\n}\n\n.typebot-input {\n  color: var(--typebot-input-color);\n  background-color: var(--typebot-input-bg-color);\n  box-shadow: 0 2px 6px -1px rgba(0, 0, 0, 0.1);\n}\n\n.typebot-input-error-message {\n  color: var(--typebot-input-color);\n}\n\n.typebot-button > .send-icon {\n  fill: var(--typebot-button-color);\n}\n\n.typebot-chat-view {\n  max-width: 800px;\n}\n\n.ping span {\n  background-color: var(--typebot-button-bg-color);\n}\n\n.rating-icon-container svg {\n  width: 42px;\n  height: 42px;\n  stroke: var(--typebot-button-bg-color);\n  fill: var(--typebot-host-bubble-bg-color);\n  transition: fill 100ms ease-out;\n}\n\n.rating-icon-container.selected svg {\n  fill: var(--typebot-button-bg-color);\n}\n\n.rating-icon-container:hover svg {\n  filter: brightness(0.9);\n}\n\n.rating-icon-container:active svg {\n  filter: brightness(0.75);\n}\n\n.upload-progress-bar {\n  background-color: var(--typebot-button-bg-color);\n}\n\n.total-files-indicator {\n  background-color: var(--typebot-button-bg-color);\n  color: var(--typebot-button-color);\n  font-size: 10px;\n}\n\n.typebot-upload-input {\n  transition: border-color 100ms ease-out;\n}\n\n.typebot-upload-input.dragging-over {\n  border-color: var(--typebot-button-bg-color);\n}\n\n.secondary-button {\n  background-color: var(--typebot-host-bubble-bg-color);\n  color: var(--typebot-host-bubble-color);\n}\n\n.hover\\:bg-gray-100:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(243 244 246 / var(--tw-bg-opacity));\n}\n\n.hover\\:brightness-90:hover {\n  --tw-brightness: brightness(.9);\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n\n.focus\\:outline-none:focus {\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n}\n\n.active\\:brightness-75:active {\n  --tw-brightness: brightness(.75);\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n\n.disabled\\:cursor-not-allowed:disabled {\n  cursor: not-allowed;\n}\n\n.disabled\\:opacity-50:disabled {\n  opacity: 0.5;\n}\n\n.disabled\\:brightness-100:disabled {\n  --tw-brightness: brightness(1);\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n\n@media (min-width: 400px) {\n\n  .xs\\:mb-2 {\n    margin-bottom: 0.5rem;\n  }\n\n  .xs\\:flex {\n    display: flex;\n  }\n\n  .xs\\:hidden {\n    display: none;\n  }\n\n  .xs\\:h-10 {\n    height: 2.5rem;\n  }\n\n  .xs\\:h-full {\n    height: 100%;\n  }\n\n  .xs\\:w-10 {\n    width: 2.5rem;\n  }\n\n  .xs\\:w-full {\n    width: 100%;\n  }\n\n  .xs\\:text-xl {\n    font-size: 1.25rem;\n    line-height: 1.75rem;\n  }\n}\n\n@media (min-width: 1024px) {\n\n  .lg\\:w-11\\/12 {\n    width: 91.666667%;\n  }\n\n  .lg\\:w-3\\/4 {\n    width: 75%;\n  }\n\n  .lg\\:w-4\\/6 {\n    width: 66.666667%;\n  }\n\n  .lg\\:px-5 {\n    padding-left: 1.25rem;\n    padding-right: 1.25rem;\n  }\n}\n']}),(0,I.jsx)("style",{children:null===(o=d.theme)||void 0===o?void 0:o.customCss}),(0,I.jsx)("style",{children:".lite-badge {\n  display: block !important;\n}\n"}),(null==d?void 0:null===(r=d.theme)||void 0===r?void 0:null===(a=r.general)||void 0===a?void 0:a.font)&&(0,I.jsx)("style",{dangerouslySetInnerHTML:{__html:"@import url('https://fonts.googleapis.com/css2?family=".concat(null!==(s=null===(i=d.theme.general)||void 0===i?void 0:i.font)&&void 0!==s?s:"Open Sans",":ital,wght@0,300;0,400;0,600;1,300;1,400;1,600&display=swap');")}}),(0,I.jsx)(nw,{typebot:d,apiHost:u,isPreview:c,onNewLog:e=>h&&h(e),isLoading:p,children:(0,I.jsx)(ng,{resultId:m,onNewAnswer:e=>f&&f(e),onVariablesUpdated:w,children:(0,I.jsxs)("div",{className:"flex text-base overflow-hidden bg-cover h-screen w-screen flex-col items-center typebot-container",style:{backgroundColor:null!=E?E:"transparent"},"data-testid":"container",children:[(0,I.jsx)("div",{className:"flex w-full h-full justify-center",children:(0,I.jsx)(oW,{theme:d.theme,onNewGroupVisible:e=>v&&v(e),onCompleted:()=>y&&y(),predefinedVariables:g,startGroupId:b})}),(null===(l=d.settings.general)||void 0===l?void 0:l.isBrandingEnabled)&&(0,I.jsx)(oX,{})]})})})]})},oY=n(5632),oZ=n(82380),oJ=n(61998);let o$=e=>{let{publishedTypebot:t,isIE:n,url:o,customHeadCode:a}=e,{asPath:r,push:i}=(0,oY.useRouter)(),[l,s]=(0,U.useState)(!1),[d,u]=(0,U.useState)(),[c,p]=(0,U.useState)(n?Error("Internet explorer is not supported"):void 0),[m,b]=(0,U.useState)(),[g,h]=(0,U.useState)([]),[v,f]=(0,U.useState)(!1);(0,U.useEffect)(()=>{var e;s(!0);let n=new URLSearchParams(location.search);y();let o={};n.forEach((e,t)=>{o[t]=e}),u(o),w().then(),(0,x.$K)(a)&&(0,x.vt)(a);let r=null===(e=t.settings.metadata)||void 0===e?void 0:e.googleTagManagerId;(0,x.UE)(r)&&document.body.prepend((0,k.I)(r))},[]);let y=()=>{var e,n;r.includes("?")&&(null!==(n=null===(e=t.settings.general)||void 0===e?void 0:e.isHideQueryParamsEnabled)&&void 0!==n?n:A.he.general.isHideQueryParamsEnabled)!==!1&&i(r.split("?")[0],void 0,{shallow:!0})},w=async()=>{let e=P();if(e)b(e);else{let{error:e,data:o}=await _(t.typebotId);if(e)return p(e);if(null==o?void 0:o.hasReachedLimit)return p(Error("This bot is now closed."));if(null==o?void 0:o.result){var n;b(o.result.id),(null===(n=t.settings.general)||void 0===n?void 0:n.isNewResultOnRefreshEnabled)!==!0&&N(o.result.id)}}};(0,U.useEffect)(()=>{m&&0!==g.length&&(Promise.all(g.map(S(m))).then(),h([]))},[m]);let E=async e=>{if(!m)return h([...g,e]);await S(m)(e)},S=e=>async t=>{let{error:n}=await C(e,{variables:t});n&&p(n)},L=async e=>{if(!m)return p(Error("Error: result was not created"));let{error:t}=await T({...e,resultId:m});t&&p(t),v||C(m,{hasStarted:!0}).then(e=>{let{error:t}=e;return t?p(t):f(!0)})},R=async()=>{if(!m)return p(Error("Error: result was not created"));let{error:e}=await C(m,{isCompleted:!0});e&&p(e)};return c?(0,I.jsx)(oZ.m,{error:c}):(0,I.jsxs)("div",{style:{height:"100vh"},children:[(0,I.jsx)(oJ.H,{url:o,typebotName:t.typebot.name,metadata:t.settings.metadata}),l&&(0,I.jsx)(oq,{typebot:t,resultId:m,predefinedVariables:d,onNewAnswer:L,onCompleted:R,onVariablesUpdated:E,isLoading:(0,x.z4)(m)})]})}},54260:function(e,t,n){"use strict";n.d(t,{I:function(){return a},J:function(){return o}});let o=e=>"<!-- Google Tag Manager -->\n(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n})(window,document,'script','dataLayer','".concat(e,"');\n<!-- End Google Tag Manager -->"),a=e=>{if(document.getElementById("gtm-noscript"))return"";let t=document.createElement("noscript");t.id="gtm-noscript";let n=document.createElement("iframe");return n.src="https://www.googletagmanager.com/ns.html?id=".concat(e),n.height="0",n.width="0",n.style.display="none",n.style.visibility="hidden",t.appendChild(n),t}},14741:function(e,t,n){"use strict";n.d(t,{O:function(){return R}});var o=n(39872),a=n(30195);n(93542);let r=(e,t)=>{var n;return window.__ENV?null!==(n=window.__ENV[e])&&void 0!==n?n:t:void 0};var i=n(93542);let l=a.z.enum(["true","false"]).transform(e=>"true"===e),s={server:{NODE_ENV:a.z.enum(["development","staging","production","test"]).optional(),DATABASE_URL:a.z.string().url().refine(e=>e.startsWith("postgres")||e.startsWith("mysql")),ENCRYPTION_SECRET:a.z.string().length(32),NEXTAUTH_URL:a.z.preprocess(e=>e&&"string"==typeof e&&e.length>0||"preview"!==i.env.VERCEL_ENV||!i.env.VERCEL_BUILDER_PROJECT_NAME||!i.env.NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME?e:i.env.VERCEL_BRANCH_URL.includes(i.env.VERCEL_BUILDER_PROJECT_NAME)?"https://".concat(i.env.VERCEL_BRANCH_URL):"https://".concat(i.env.VERCEL_BRANCH_URL).replace(i.env.NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME,i.env.VERCEL_BUILDER_PROJECT_NAME),a.z.string().url()),DISABLE_SIGNUP:l.optional().default("false"),ADMIN_EMAIL:a.z.string().min(1).optional().transform(e=>null==e?void 0:e.split(",")),DEFAULT_WORKSPACE_PLAN:a.z.enum(["FREE","STARTER","PRO","LIFETIME","UNLIMITED"]).refine(e=>["FREE","STARTER","PRO","LIFETIME","UNLIMITED"].includes(e)).default("FREE"),DEBUG:l.optional().default("false"),CHAT_API_TIMEOUT:a.z.coerce.number().optional(),RADAR_HIGH_RISK_KEYWORDS:a.z.string().min(1).transform(e=>e.split(",")).optional(),RADAR_INTERMEDIATE_RISK_KEYWORDS:a.z.string().min(1).transform(e=>e.split(",")).optional(),RADAR_CUMULATIVE_KEYWORDS:a.z.string().min(1).transform(e=>e.split("/").map(e=>e.split(",").map(e=>e.split("|")))).optional(),LANDING_PAGE_URL:a.z.preprocess(e=>e&&"string"==typeof e&&e.length>0||"preview"!==i.env.VERCEL_ENV||!i.env.VERCEL_LANDING_PROJECT_NAME?e:"https://".concat(i.env.VERCEL_BRANCH_URL),a.z.string().url().optional())},client:{NEXT_PUBLIC_E2E_TEST:l.optional(),NEXT_PUBLIC_VIEWER_URL:a.z.preprocess(e=>e&&"string"==typeof e&&e.length>0||"preview"!==i.env.VERCEL_ENV||!i.env.VERCEL_BUILDER_PROJECT_NAME||!i.env.NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME?e:i.env.VERCEL_BRANCH_URL.includes(i.env.NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME)?"https://".concat(i.env.VERCEL_BRANCH_URL):"https://".concat(i.env.VERCEL_BRANCH_URL).replace(i.env.VERCEL_BUILDER_PROJECT_NAME,i.env.NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME),a.z.string().min(1).transform(e=>e.split(","))),NEXT_PUBLIC_ONBOARDING_TYPEBOT_ID:a.z.string().min(1).optional(),NEXT_PUBLIC_BOT_FILE_UPLOAD_MAX_SIZE:a.z.coerce.number().optional(),NEXT_PUBLIC_CHAT_API_URL:a.z.string().url().optional(),NEXT_PUBLIC_USE_EXPERIMENTAL_CHAT_API_ON:a.z.string().min(1).transform(e=>e.split("/").map(e=>e.split(",").map(e=>e.split("|")))).optional(),NEXT_PUBLIC_VIEWER_404_TITLE:a.z.string().optional().default("404"),NEXT_PUBLIC_VIEWER_404_SUBTITLE:a.z.string().optional().default("The bot you're looking for doesn't exist")},runtimeEnv:{NEXT_PUBLIC_E2E_TEST:r("NEXT_PUBLIC_E2E_TEST"),NEXT_PUBLIC_VIEWER_URL:r("NEXT_PUBLIC_VIEWER_URL"),NEXT_PUBLIC_ONBOARDING_TYPEBOT_ID:r("NEXT_PUBLIC_ONBOARDING_TYPEBOT_ID"),NEXT_PUBLIC_BOT_FILE_UPLOAD_MAX_SIZE:r("NEXT_PUBLIC_BOT_FILE_UPLOAD_MAX_SIZE"),NEXT_PUBLIC_CHAT_API_URL:r("NEXT_PUBLIC_CHAT_API_URL"),NEXT_PUBLIC_USE_EXPERIMENTAL_CHAT_API_ON:r("NEXT_PUBLIC_USE_EXPERIMENTAL_CHAT_API_ON"),NEXT_PUBLIC_VIEWER_404_TITLE:r("NEXT_PUBLIC_VIEWER_404_TITLE"),NEXT_PUBLIC_VIEWER_404_SUBTITLE:r("NEXT_PUBLIC_VIEWER_404_SUBTITLE")}},d={server:{GITHUB_CLIENT_ID:a.z.string().min(1).optional(),GITHUB_CLIENT_SECRET:a.z.string().min(1).optional()}},u={server:{FACEBOOK_CLIENT_ID:a.z.string().min(1).optional(),FACEBOOK_CLIENT_SECRET:a.z.string().min(1).optional()}},c={server:{SMTP_USERNAME:a.z.string().min(1).optional(),SMTP_PASSWORD:a.z.string().min(1).optional(),SMTP_HOST:a.z.string().min(1).optional(),SMTP_PORT:a.z.coerce.number().optional().default(25),SMTP_AUTH_DISABLED:l.optional().default("false"),SMTP_SECURE:l.optional().default("false")},client:{NEXT_PUBLIC_SMTP_FROM:a.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_SMTP_FROM:r("NEXT_PUBLIC_SMTP_FROM")}},p={server:{GITLAB_CLIENT_ID:a.z.string().min(1).optional(),GITLAB_CLIENT_SECRET:a.z.string().min(1).optional(),GITLAB_BASE_URL:a.z.string().url().optional().default("https://gitlab.com"),GITLAB_NAME:a.z.string().min(1).optional().default("GitLab"),GITLAB_REQUIRED_GROUPS:a.z.string().transform(e=>e?e.split(","):void 0).optional()}},m={server:{AZURE_AD_CLIENT_ID:a.z.string().min(1).optional(),AZURE_AD_CLIENT_SECRET:a.z.string().min(1).optional(),AZURE_AD_TENANT_ID:a.z.string().min(1).optional()}},b={server:{CUSTOM_OAUTH_NAME:a.z.string().min(1).optional().default("Custom OAuth"),CUSTOM_OAUTH_SCOPE:a.z.string().min(1).optional().default("openid profile email"),CUSTOM_OAUTH_CLIENT_ID:a.z.string().min(1).optional(),CUSTOM_OAUTH_CLIENT_SECRET:a.z.string().min(1).optional(),CUSTOM_OAUTH_WELL_KNOWN_URL:a.z.string().url().optional(),CUSTOM_OAUTH_USER_ID_PATH:a.z.string().min(1).optional().default("id"),CUSTOM_OAUTH_USER_EMAIL_PATH:a.z.string().min(1).optional().default("email"),CUSTOM_OAUTH_USER_NAME_PATH:a.z.string().min(1).optional().default("name"),CUSTOM_OAUTH_USER_IMAGE_PATH:a.z.string().min(1).optional().default("image")}},g={server:{GOOGLE_AUTH_CLIENT_ID:a.z.string().min(1).optional(),GOOGLE_AUTH_CLIENT_SECRET:a.z.string().min(1).optional()}},h={server:{GOOGLE_SHEETS_CLIENT_ID:a.z.string().min(1).optional(),GOOGLE_SHEETS_CLIENT_SECRET:a.z.string().min(1).optional()},client:{NEXT_PUBLIC_GOOGLE_SHEETS_API_KEY:a.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_GOOGLE_SHEETS_API_KEY:r("NEXT_PUBLIC_GOOGLE_SHEETS_API_KEY")}},v={client:{NEXT_PUBLIC_GOOGLE_FONTS_API_KEY:a.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_GOOGLE_FONTS_API_KEY:r("NEXT_PUBLIC_GOOGLE_FONTS_API_KEY")}},f={server:{STRIPE_SECRET_KEY:a.z.string().min(1).optional(),STRIPE_WEBHOOK_SECRET:a.z.string().min(1).optional(),STRIPE_STARTER_PRICE_ID:a.z.string().min(1).optional(),STRIPE_STARTER_CHATS_PRICE_ID:a.z.string().min(1).optional(),STRIPE_PRO_PRICE_ID:a.z.string().min(1).optional(),STRIPE_PRO_CHATS_PRICE_ID:a.z.string().min(1).optional()},client:{NEXT_PUBLIC_STRIPE_PUBLIC_KEY:a.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_STRIPE_PUBLIC_KEY:r("NEXT_PUBLIC_STRIPE_PUBLIC_KEY")}},y={server:{S3_ACCESS_KEY:a.z.string().min(1).optional(),S3_SECRET_KEY:a.z.string().min(1).optional(),S3_BUCKET:a.z.string().min(1).optional().default("typebot"),S3_PORT:a.z.coerce.number().optional(),S3_ENDPOINT:a.z.string().min(1).optional(),S3_SSL:l.optional().default("true"),S3_REGION:a.z.string().min(1).optional(),S3_PUBLIC_CUSTOM_DOMAIN:a.z.string().url().optional()}},w={client:{NEXT_PUBLIC_GIPHY_API_KEY:a.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_GIPHY_API_KEY:r("NEXT_PUBLIC_GIPHY_API_KEY")}},E={server:{VERCEL_TOKEN:a.z.string().min(1).optional(),VERCEL_TEAM_ID:a.z.string().min(1).optional(),VERCEL_GIT_COMMIT_SHA:a.z.string().min(1).optional(),VERCEL_BUILDER_PROJECT_NAME:a.z.string().min(1).optional(),VERCEL_LANDING_PROJECT_NAME:a.z.string().min(1).optional()},client:{NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME:a.z.string().min(1).optional(),NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA:a.z.string().min(1).optional(),NEXT_PUBLIC_VERCEL_ENV:a.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME:r("NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME"),NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA:r("NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA"),NEXT_PUBLIC_VERCEL_ENV:r("NEXT_PUBLIC_VERCEL_ENV")}},I={server:{SLEEKPLAN_SSO_KEY:a.z.string().min(1).optional()}},x={client:{NEXT_PUBLIC_UNSPLASH_APP_NAME:a.z.string().min(1).optional(),NEXT_PUBLIC_UNSPLASH_ACCESS_KEY:a.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_UNSPLASH_APP_NAME:r("NEXT_PUBLIC_UNSPLASH_APP_NAME"),NEXT_PUBLIC_UNSPLASH_ACCESS_KEY:r("NEXT_PUBLIC_UNSPLASH_ACCESS_KEY")}},T={client:{NEXT_PUBLIC_PEXELS_API_KEY:a.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_PEXELS_API_KEY:r("NEXT_PUBLIC_PEXELS_API_KEY")}},_={server:{META_SYSTEM_USER_TOKEN:a.z.string().min(1).optional(),WHATSAPP_PREVIEW_FROM_PHONE_NUMBER_ID:a.z.string().min(1).optional(),WHATSAPP_PREVIEW_TEMPLATE_NAME:a.z.string().min(1).optional(),WHATSAPP_PREVIEW_TEMPLATE_LANG:a.z.string().min(1).optional().default("en_US"),WHATSAPP_CLOUD_API_URL:a.z.string().url().optional().default("https://graph.facebook.com"),WHATSAPP_INTERACTIVE_GROUP_SIZE:a.z.coerce.number().optional().default(3)}},C={server:{REDIS_URL:a.z.string().url().optional()}},S={server:{SENTRY_DSN:a.z.string().min(1).optional(),SENTRY_AUTH_TOKEN:a.z.string().min(1).optional(),SENTRY_PROJECT:a.z.string().min(1).optional(),SENTRY_ORG:a.z.string().min(1).optional()}},P={server:{MESSAGE_WEBHOOK_URL:a.z.string().url().optional(),USER_CREATED_WEBHOOK_URL:a.z.string().url().optional()}},N={client:{NEXT_PUBLIC_POSTHOG_KEY:a.z.string().min(1).optional(),NEXT_PUBLIC_POSTHOG_HOST:a.z.string().min(1).optional().default("https://app.posthog.com")},runtimeEnv:{NEXT_PUBLIC_POSTHOG_KEY:r("NEXT_PUBLIC_POSTHOG_KEY"),NEXT_PUBLIC_POSTHOG_HOST:r("NEXT_PUBLIC_POSTHOG_HOST")}},k={client:{NEXT_PUBLIC_TOLGEE_API_KEY:a.z.string().min(1).optional(),NEXT_PUBLIC_TOLGEE_API_URL:a.z.string().url().optional().default('https://tolgee.server.baptistearno.com"')},runtimeEnv:{NEXT_PUBLIC_TOLGEE_API_KEY:r("NEXT_PUBLIC_TOLGEE_API_KEY"),NEXT_PUBLIC_TOLGEE_API_URL:r("NEXT_PUBLIC_TOLGEE_API_URL","https://tolgee.server.baptistearno.com")}},A={server:{KEYCLOAK_CLIENT_ID:a.z.string().min(1).optional(),KEYCLOAK_CLIENT_SECRET:a.z.string().min(1).optional(),KEYCLOAK_REALM:a.z.string().min(1).optional(),KEYCLOAK_BASE_URL:a.z.string().url().optional()}},L={client:{NEXT_PUBLIC_PARTYKIT_HOST:a.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_PARTYKIT_HOST:r("NEXT_PUBLIC_PARTYKIT_HOST")}},R=(0,o.D)({server:{...s.server,...d.server,...u.server,...c.server,...g.server,...h.server,...f.server,...y.server,...E.server,...I.server,..._.server,...C.server,...p.server,...m.server,...b.server,...S.server,...P.server,...A.server},client:{...s.client,...c.client,...h.client,...v.client,...f.client,...w.client,...E.client,...x.client,...T.client,...N.client,...k.client,...L.client},experimental__runtimeEnv:{...s.runtimeEnv,...c.runtimeEnv,...h.runtimeEnv,...v.runtimeEnv,...f.runtimeEnv,...w.runtimeEnv,...E.runtimeEnv,...x.runtimeEnv,...T.runtimeEnv,...N.runtimeEnv,...k.runtimeEnv,...L.runtimeEnv},skipValidation:"true"===i.env.SKIP_ENV_CHECK||void 0===window.__ENV,onValidationError(e){throw console.error("❌ Invalid environment variables:",e.flatten().fieldErrors),Error("Invalid environment variables: ".concat(JSON.stringify(e.flatten().fieldErrors)))},onInvalidAccess:e=>{throw Error("❌ Attempted to access a server-side environment variable on the client: ".concat(e))}})},32548:function(e,t,n){"use strict";n.d(t,{$K:function(){return a},L7:function(){return s},Nm:function(){return u},UE:function(){return l},vt:function(){return c},wG:function(){return o},xb:function(){return i},z4:function(){return r}});let o=async e=>{let t;try{let n="string"==typeof e?e:e.url;t=await fetch(n,{method:"string"==typeof e?"GET":e.method,mode:"cors",headers:"string"!=typeof e&&a(e.body)?{"Content-Type":"application/json"}:void 0,body:"string"!=typeof e&&a(e.body)?JSON.stringify(e.body):void 0});let o=await t.json();if(!t.ok)throw"error"in o?o.error:o;return{data:o,response:t}}catch(e){return console.error(e),{error:e,response:t}}},a=e=>null!=e,r=e=>null==e,i=e=>null==e||""===e,l=e=>null!=e&&""!==e,s=e=>t=>t.id===e,d=e=>/^\{\{.*\}\}$/.test(e),u=e=>e.startsWith("http")||e.startsWith("mailto:")||e.startsWith("tel:")||e.startsWith("sms:")||d(e)?e:"https://".concat(e),c=e=>{e.split("</noscript>").forEach(e=>{let[t,n]=e.split("<noscript>"),o=document.createRange().createContextualFragment(null!=t?t:"");if(document.head.append(o),r(n))return;let a=document.createElement("noscript"),i=document.createRange().createContextualFragment(n);a.append(i),document.head.append(a)})}},78326:function(e,t,n){"use strict";n.d(t,{he:function(){return o}});let o={general:{isInputPrefillEnabled:!1,isHideQueryParamsEnabled:!0,isNewResultOnRefreshEnabled:!0,rememberUser:{isEnabled:!1,storage:"session"},isBrandingEnabled:!1,isTypingEmulationEnabled:!0},typingEmulation:{enabled:!0,speed:400,maxDelay:3,delayBetweenBubbles:0,isDisabledOnFirstMessage:!0},metadata:{description:"Build beautiful conversational forms and embed them directly in your applications without a line of code. Triple your response rate and collect answers that has more value compared to a traditional form.",favIconUrl:e=>e+"/favicon.png",imageUrl:e=>e+"/site-preview.png"}}},24945:function(e,t,n){"use strict";var o,a;n.d(t,{Eo:function(){return o},JA:function(){return i},qP:function(){return r}}),(a=o||(o={})).COLOR="Color",a.IMAGE="Image",a.NONE="None";let r="Color",i="#ffffff"},53260:function(){},32037:function(){},70767:function(){},91331:function(){},31587:function(e,t,n){"use strict";n.d(t,{a:function(){return o},b:function(){return a}});var o=e=>{e&&gtag("event",e.action,{event_category:e.category,event_label:e.label,value:e.value})},a=e=>new Promise(t=>{let n=document.getElementById("gtag");if(!n){let n=document.createElement("script");n.src="https://www.googletagmanager.com/gtag/js?id=".concat(e),n.id="gtag";let o=document.createElement("script");o.innerHTML="window.dataLayer = window.dataLayer || [];\n      function gtag(){dataLayer.push(arguments);}\n      gtag('js', new Date());\n\n      gtag('config', '".concat(e,"');\n      "),document.body.appendChild(n),document.body.appendChild(o),n.onload=()=>{t()}}n&&t()})}}]);